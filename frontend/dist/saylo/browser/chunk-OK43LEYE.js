import{a as Y,c as q,e as R,j as J}from"./chunk-WU2R6EY6.js";import{Aa as D,B as U,Ba as l,Ca as u,Da as w,E as F,Ea as O,Fa as T,Ga as I,I as g,Ia as N,J as _,K as x,L as v,Qa as j,Ra as G,Sa as H,T as r,U as k,Ua as B,c as z,cb as E,db as Q,eb as W,fa as m,ha as d,ia as M,ja as C,ma as a,na as o,oa as h,pa as P,qa as S,ra as y,ta as f,v as b,va as p,y as L,ya as $,za as A}from"./chunk-WQXZ4LHS.js";import"./chunk-2H7K6JAD.js";var K=(()=>{class i{constructor(e){this.http=e,this.chatApi=`${E.apiUrl}/chats`,this.messageApi=`${E.apiUrl}/messages`,this.userApi=`${E.apiUrl}/users`}getChats(){return this.http.get(this.chatApi)}createOrGetDirectChat(e){return this.http.post(`${this.chatApi}/direct`,{targetUserId:e})}createGroupChat(e,n){return this.http.post(`${this.chatApi}/group`,{name:e,participantIds:n})}deleteChat(e){return this.http.delete(`${this.chatApi}/${e}`)}getMessages(e,n=1){return this.http.get(`${this.messageApi}/${e}?page=${n}&limit=50`)}sendMessage(e,n){return this.http.post(`${this.messageApi}/${e}`,{content:n})}deleteMessage(e){return this.http.delete(`${this.messageApi}/${e}`)}markAsRead(e){return this.http.post(`${this.messageApi}/${e}/read`,{})}getUsers(){return this.http.get(this.userApi)}searchUsers(e){return this.http.get(`${this.userApi}/search?q=${e}`)}static{this.\u0275fac=function(n){return new(n||i)(U(B))}}static{this.\u0275prov=L({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var ee=["scrollEl"],te=["anchor"];function ne(i,c){i&1&&(a(0,"div",50),x(),a(1,"svg",51),h(2,"path",52),o(),v(),a(3,"p"),l(4,"No conversations yet"),o(),a(5,"span"),l(6,"Tap + to start one"),o()())}function ie(i,c){i&1&&h(0,"div",28)}function ae(i,c){if(i&1&&(a(0,"span",62),l(1),o()),i&2){let e=p().$implicit;r(),u(e.unread)}}function oe(i,c){if(i&1){let e=y();a(0,"div",53),f("click",function(){let t=g(e).$implicit,s=p(2);return _(s.openChat(t))}),a(1,"div",54),l(2),m(3,ie,1,0,"div",55),o(),a(4,"div",56)(5,"div",57)(6,"span",58),l(7),o(),a(8,"span",59),l(9),o()(),a(10,"div",57)(11,"span",60),l(12),o(),m(13,ae,2,1,"span",61),o()()()}if(i&2){let e=c.$implicit,n=p(2);C("active",(n.activeChat==null?null:n.activeChat._id)===e._id),r(),M("background",n.colorFor(n.getChatName(e))),r(),w(" ",n.getChatName(e).charAt(0).toUpperCase()," "),r(),d("ngIf",n.isOnline(e)),r(4),u(n.getChatName(e)),r(2),u(n.ago(e.lastActivity)),r(3),u(e.lastMessageText||"Start a conversation"),r(),d("ngIf",e.unread&&e.unread>0)}}function re(i,c){if(i&1&&(a(0,"div",47),m(1,ne,7,0,"div",48)(2,oe,14,10,"div",49),o()),i&2){let e=p();r(),d("ngIf",e.filteredChats.length===0),r(),d("ngForOf",e.filteredChats)}}function se(i,c){i&1&&(a(0,"div",65),h(1,"div",66),l(2," Loading... "),o())}function le(i,c){i&1&&(a(0,"div",50)(1,"p"),l(2,"No users found"),o()())}function ce(i,c){i&1&&h(0,"div",28)}function de(i,c){i&1&&(a(0,"span",68),l(1,"Online"),o())}function pe(i,c){if(i&1){let e=y();a(0,"div",53),f("click",function(){let t=g(e).$implicit,s=p(2);return _(s.startChat(t))}),a(1,"div",54),l(2),m(3,ce,1,0,"div",55),o(),a(4,"div",56)(5,"div",57)(6,"span",58),l(7),o(),m(8,de,2,0,"span",67),o(),a(9,"span",60),l(10),o()()()}if(i&2){let e=c.$implicit,n=p(2);r(),M("background",n.colorFor(e.name)),r(),w(" ",e.name.charAt(0).toUpperCase()," "),r(),d("ngIf",n.onlineIds.includes(e._id)),r(4),u(e.name),r(),d("ngIf",n.onlineIds.includes(e._id)),r(2),u(e.email)}}function he(i,c){if(i&1&&(a(0,"div",47),m(1,se,3,0,"div",63)(2,le,3,0,"div",48)(3,pe,11,7,"div",64),o()),i&2){let e=p();r(),d("ngIf",e.loadingPeople),r(),d("ngIf",!e.loadingPeople&&e.filteredPeople.length===0),r(),d("ngForOf",e.filteredPeople)}}function me(i,c){if(i&1){let e=y();a(0,"div",69)(1,"div",70),x(),a(2,"svg",71),h(3,"path",52),o(),v(),a(4,"h3"),l(5,"Pick a conversation"),o(),a(6,"p"),l(7,"Select a chat from the sidebar or start a new one"),o(),a(8,"button",72),f("click",function(){g(e);let t=p();return _(t.openNewChatModal())}),l(9," Start a conversation "),o()()()}}function ge(i,c){i&1&&h(0,"div",28)}function _e(i,c){i&1&&(P(0),a(1,"span",101),l(2,"typing..."),o(),S())}function fe(i,c){i&1&&(a(0,"span",104),l(1,"Online"),o())}function xe(i,c){i&1&&(a(0,"span",105),l(1,"Offline"),o())}function ue(i,c){if(i&1&&(P(0),m(1,fe,2,0,"span",102)(2,xe,2,0,"span",103),S()),i&2){let e=p(2);r(),d("ngIf",e.isOnline(e.activeChat)),r(),d("ngIf",!e.isOnline(e.activeChat))}}function ve(i,c){i&1&&(a(0,"div",106),h(1,"div",66),o())}function be(i,c){i&1&&(a(0,"div",107)(1,"p"),l(2,"No messages yet \u2014 say hello! \u{1F44B}"),o()())}function Ce(i,c){if(i&1&&(a(0,"div",117)(1,"span"),l(2),o()()),i&2){let e=p().$implicit,n=p(2);r(2),u(n.formatDate(e.createdAt))}}function ye(i,c){if(i&1&&(a(0,"div",118),l(1),o()),i&2){let e=p().$implicit,n=p(2);M("background",n.colorFor((e.sender==null?null:e.sender.name)||"")),r(),w(" ",((e.sender==null?null:e.sender.name)||"U").charAt(0).toUpperCase()," ")}}function we(i,c){if(i&1&&(a(0,"span",119),l(1),o()),i&2){let e=p().$implicit;r(),u(e.sender==null?null:e.sender.name)}}function Me(i,c){i&1&&(x(),a(0,"svg",120),h(1,"polyline",121),o())}function ke(i,c){if(i&1&&(P(0),m(1,Ce,3,1,"div",108),a(2,"div",109),m(3,ye,2,3,"div",110),a(4,"div",111),m(5,we,2,1,"span",112),a(6,"div",113),l(7),o(),a(8,"div",114)(9,"span",115),l(10),o(),m(11,Me,2,0,"svg",116),o()()(),S()),i&2){let e=c.$implicit,n=c.index,t=p(2);r(),d("ngIf",t.showDateSep(n)),r(),C("mine",t.isMine(e)),r(),d("ngIf",!t.isMine(e)),r(2),d("ngIf",t.activeChat.type==="group"&&!t.isMine(e)),r(),C("mine-bubble",t.isMine(e))("deleted",e.isDeleted),r(),w(" ",e.content," "),r(),C("mine-meta",t.isMine(e)),r(2),u(t.formatTime(e.createdAt)),r(),d("ngIf",t.isMine(e))}}function Pe(i,c){i&1&&(a(0,"div",109)(1,"div",122),l(2,"..."),o(),a(3,"div",111)(4,"div",123),h(5,"span")(6,"span")(7,"span"),o()()())}function Se(i,c){if(i&1){let e=y();a(0,"div",73)(1,"div",74)(2,"button",75),f("click",function(){g(e);let t=p();return t.activeChat=null,_(t.sidebarOpen=!0)}),x(),a(3,"svg",13),h(4,"polyline",76),o()(),v(),a(5,"div",54),l(6),m(7,ge,1,0,"div",55),o(),a(8,"div",77)(9,"span",78),l(10),o(),a(11,"span",79),m(12,_e,3,0,"ng-container",80)(13,ue,3,2,"ng-container",80),o()(),a(14,"div",81)(15,"button",82),x(),a(16,"svg",83),h(17,"path",84),o()(),v(),a(18,"button",85),x(),a(19,"svg",83),h(20,"polygon",86)(21,"rect",87),o()()()(),v(),a(22,"div",88,0)(24,"div",89),m(25,ve,2,0,"div",90)(26,be,3,0,"div",91)(27,ke,12,14,"ng-container",92)(28,Pe,8,0,"div",93),h(29,"div",null,1),o()(),a(31,"div",94)(32,"div",95)(33,"div",96)(34,"input",97,2),I("ngModelChange",function(t){g(e);let s=p();return T(s.msgText,t)||(s.msgText=t),_(t)}),f("keydown.enter",function(){g(e);let t=p();return _(t.send())})("input",function(){g(e);let t=p();return _(t.onTyping())})("focus",function(){g(e);let t=p();return _(t.inputFocused=!0)})("blur",function(){g(e);let t=p();return _(t.inputFocused=!1)}),o()(),a(36,"button",98),f("click",function(){g(e);let t=p();return _(t.send())}),x(),a(37,"svg",83),h(38,"line",99)(39,"polygon",100),o()()()()()}if(i&2){let e=p();r(5),M("background",e.colorFor(e.getChatName(e.activeChat))),r(),w(" ",e.getChatName(e.activeChat).charAt(0).toUpperCase()," "),r(),d("ngIf",e.isOnline(e.activeChat)),r(3),u(e.getChatName(e.activeChat)),r(2),d("ngIf",e.typingUsers.length>0),r(),d("ngIf",e.typingUsers.length===0),r(12),d("ngIf",e.loadingMsgs),r(),d("ngIf",!e.loadingMsgs&&e.messages.length===0),r(),d("ngForOf",e.messages),r(),d("ngIf",e.typingUsers.length>0),r(5),C("focused",e.inputFocused),r(),O("ngModel",e.msgText),d("disabled",e.sending),r(2),d("disabled",!e.msgText.trim()||e.sending)}}function Oe(i,c){i&1&&(a(0,"div",65),h(1,"div",66),l(2," Loading people... "),o())}function Te(i,c){i&1&&h(0,"div",28)}function Ie(i,c){if(i&1){let e=y();a(0,"div",53),f("click",function(){let t=g(e).$implicit,s=p(2);return s.startChat(t),_(s.showModal=!1)}),a(1,"div",54),l(2),m(3,Te,1,0,"div",55),o(),a(4,"div",56)(5,"span",58),l(6),o(),a(7,"span",60),l(8),o()()()}if(i&2){let e=c.$implicit,n=p(2);r(),M("background",n.colorFor(e.name)),r(),w(" ",e.name.charAt(0).toUpperCase()," "),r(),d("ngIf",n.onlineIds.includes(e._id)),r(3),u(e.name),r(2),u(e.email)}}function Ee(i,c){i&1&&(a(0,"div",133)(1,"p"),l(2,"No users found"),o()())}function Ve(i,c){if(i&1){let e=y();a(0,"div",124),f("click",function(){g(e);let t=p();return _(t.showModal=!1)}),a(1,"div",125),f("click",function(t){return g(e),_(t.stopPropagation())}),a(2,"div",126)(3,"h3"),l(4,"New Conversation"),o(),a(5,"button",38),f("click",function(){g(e);let t=p();return _(t.showModal=!1)}),x(),a(6,"svg",83),h(7,"line",127)(8,"line",128),o()()(),v(),a(9,"div",129)(10,"div",17),x(),a(11,"svg",18),h(12,"circle",19)(13,"line",20),o(),v(),a(14,"input",130),I("ngModelChange",function(t){g(e);let s=p();return T(s.modalSearch,t)||(s.modalSearch=t),_(t)}),o()()(),a(15,"div",131),m(16,Oe,3,0,"div",63)(17,Ie,9,6,"div",64)(18,Ee,3,0,"div",132),o()()()}if(i&2){let e=p();r(14),O("ngModel",e.modalSearch),r(2),d("ngIf",e.loadingPeople),r(),d("ngForOf",e.filteredModalPeople),r(),d("ngIf",!e.loadingPeople&&e.filteredModalPeople.length===0)}}function $e(i,c){if(i&1){let e=y();a(0,"div",134),f("click",function(){g(e);let t=p();return _(t.sidebarOpen=!1)}),o()}}var He=(()=>{class i{constructor(e,n,t){this.auth=e,this.socket=n,this.chatSvc=t,this.destroy$=new z,this.me=null,this.chats=[],this.messages=[],this.people=[],this.activeChat=null,this.onlineIds=[],this.typingUsers=[],this.tab="chats",this.searchQ="",this.modalSearch="",this.msgText="",this.inputFocused=!1,this.sending=!1,this.sidebarOpen=!1,this.showModal=!1,this.loadingPeople=!1,this.loadingMsgs=!1,this.shouldScroll=!1,this.typingTimer=null}ngOnInit(){this.me=this.auth.currentUser$(),this.loadChats(),this.setupSocket()}ngAfterViewChecked(){this.shouldScroll&&(this.scrollToBottom(),this.shouldScroll=!1)}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.activeChat&&this.socket.leaveChat(this.activeChat._id)}loadChats(){this.chatSvc.getChats().pipe(b(this.destroy$)).subscribe({next:e=>{this.chats=e.data||[]}})}openChat(e){this.activeChat&&this.socket.leaveChat(this.activeChat._id),this.activeChat=e,this.messages=[],this.typingUsers=[],this.sidebarOpen=!1,this.socket.joinChat(e._id),this.loadMessages(e._id),this.chatSvc.markAsRead(e._id).pipe(b(this.destroy$)).subscribe()}loadMessages(e){this.loadingMsgs=!0,this.chatSvc.getMessages(e).pipe(b(this.destroy$)).subscribe({next:n=>{this.messages=n.data||[],this.loadingMsgs=!1,this.shouldScroll=!0},error:()=>{this.loadingMsgs=!1}})}send(){let e=this.msgText.trim();!e||!this.activeChat||this.sending||(this.sending=!0,this.msgText="",this.chatSvc.sendMessage(this.activeChat._id,e).pipe(b(this.destroy$)).subscribe({next:n=>{this.messages.push(n.data),this.shouldScroll=!0,this.sending=!1;let t=this.chats.find(s=>s._id===this.activeChat?._id);t&&(t.lastMessageText=e,t.lastActivity=new Date().toISOString())},error:()=>{this.msgText=e,this.sending=!1}}))}startChat(e){this.chatSvc.createOrGetDirectChat(e._id).pipe(b(this.destroy$)).subscribe({next:n=>{let t=n.data;this.chats.find(s=>s._id===t._id)||this.chats.unshift(t),this.openChat(t),this.tab="chats"}})}onTyping(){!this.activeChat||!this.me||(this.socket.sendTypingStart(this.activeChat._id,this.me._id,this.me.name),this.typingTimer&&clearTimeout(this.typingTimer),this.typingTimer=setTimeout(()=>{this.activeChat&&this.me&&this.socket.sendTypingStop(this.activeChat._id,this.me._id)},1500))}switchToPeople(){this.tab="people",this.people.length===0&&this.fetchPeople()}openNewChatModal(){this.showModal=!0,this.people.length===0&&this.fetchPeople()}fetchPeople(){this.loadingPeople=!0,this.chatSvc.getUsers().pipe(b(this.destroy$)).subscribe({next:e=>{this.people=e.data||[],this.loadingPeople=!1},error:()=>{this.loadingPeople=!1}})}setupSocket(){this.socket.on("users:online-list").pipe(b(this.destroy$)).subscribe(e=>{this.onlineIds=e}),this.socket.on("message:received").pipe(b(this.destroy$)).subscribe(e=>{this.activeChat&&e.chat===this.activeChat._id&&(this.messages.find(s=>s._id===e._id)||(this.messages.push(e),this.shouldScroll=!0));let n=this.chats.find(t=>t._id===e.chat);n&&(n.lastMessageText=e.content,n.lastActivity=e.createdAt)}),this.socket.on("message:deleted").pipe(b(this.destroy$)).subscribe(({messageId:e})=>{let n=this.messages.find(t=>t._id===e);n&&(n.isDeleted=!0,n.content="This message was deleted")}),this.socket.on("typing:started").pipe(b(this.destroy$)).subscribe(({userId:e})=>{e!==this.me?._id&&!this.typingUsers.includes(e)&&this.typingUsers.push(e)}),this.socket.on("typing:stopped").pipe(b(this.destroy$)).subscribe(({userId:e})=>{this.typingUsers=this.typingUsers.filter(n=>n!==e)})}getChatName(e){return e.type==="group"?e.name||"Group Chat":e.participants?.find(t=>t.user?._id!==this.me?._id)?.user?.name||"Unknown"}isOnline(e){if(e.type==="group")return!1;let n=e.participants?.find(t=>t.user?._id!==this.me?._id);return n?this.onlineIds.includes(n.user?._id):!1}isMine(e){return(e.sender?._id??e.sender)===this.me?._id}get filteredChats(){if(!this.searchQ)return this.chats;let e=this.searchQ.toLowerCase();return this.chats.filter(n=>this.getChatName(n).toLowerCase().includes(e))}get filteredPeople(){if(!this.searchQ)return this.people;let e=this.searchQ.toLowerCase();return this.people.filter(n=>n.name.toLowerCase().includes(e)||n.email.toLowerCase().includes(e))}get filteredModalPeople(){if(!this.modalSearch)return this.people;let e=this.modalSearch.toLowerCase();return this.people.filter(n=>n.name.toLowerCase().includes(e)||n.email.toLowerCase().includes(e))}colorFor(e){let n=["#2563eb","#7c3aed","#db2777","#ea580c","#16a34a","#0891b2","#9333ea","#0f766e"],t=0;for(let s=0;s<e.length;s++)t=e.charCodeAt(s)+((t<<5)-t);return n[Math.abs(t)%n.length]}showDateSep(e){if(e===0)return!0;let n=new Date(this.messages[e-1].createdAt).toDateString(),t=new Date(this.messages[e].createdAt).toDateString();return n!==t}formatDate(e){let n=new Date(e),t=new Date,s=new Date;return s.setDate(s.getDate()-1),n.toDateString()===t.toDateString()?"Today":n.toDateString()===s.toDateString()?"Yesterday":n.toLocaleDateString([],{weekday:"long",month:"short",day:"numeric"})}formatTime(e){return new Date(e).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}ago(e){if(!e)return"";let n=new Date(e),s=Math.floor((new Date().getTime()-n.getTime())/864e5);return s===0?n.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):s===1?"Yesterday":s<7?n.toLocaleDateString([],{weekday:"short"}):n.toLocaleDateString([],{day:"numeric",month:"short"})}scrollToBottom(){try{let e=this.scrollEl?.nativeElement;e&&(e.scrollTop=e.scrollHeight)}catch{}}logout(){this.auth.logout()}static{this.\u0275fac=function(n){return new(n||i)(k(W),k(Q),k(K))}}static{this.\u0275cmp=F({type:i,selectors:[["app-chat"]],viewQuery:function(n,t){if(n&1&&($(ee,5),$(te,5)),n&2){let s;A(s=D())&&(t.scrollEl=s.first),A(s=D())&&(t.anchor=s.first)}},standalone:!0,features:[N],decls:56,vars:18,consts:[["scrollEl",""],["anchor",""],["inputEl",""],[1,"shell"],[1,"sidebar"],[1,"sb-topbar"],[1,"sb-logo"],["width","20","height","20","viewBox","0 0 24 24","fill","none"],["d","M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z","fill","#2563eb"],["cx","8","cy","11","r","1","fill","white"],["cx","12","cy","11","r","1","fill","white"],["cx","16","cy","11","r","1","fill","white"],["title","New chat",1,"icon-btn",3,"click"],["width","18","height","18","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2.5","stroke-linecap","round"],["x1","12","y1","5","x2","12","y2","19"],["x1","5","y1","12","x2","19","y2","12"],[1,"sb-search-wrap"],[1,"sb-search"],["width","14","height","14","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2.5","stroke-linecap","round"],["cx","11","cy","11","r","8"],["x1","21","y1","21","x2","16.65","y2","16.65"],["type","text","placeholder","Search chats...",1,"sb-search-input",3,"ngModelChange","ngModel"],[1,"sb-tabs"],[1,"sb-tab",3,"click"],["class","sb-list",4,"ngIf"],[1,"sb-footer"],[1,"sb-profile"],[1,"avatar","sm"],[1,"green-dot"],[1,"sb-profile-name"],[1,"sb-profile-status"],["title","Sign out",1,"icon-btn","red-hover",3,"click"],["width","17","height","17","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round"],["d","M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"],["points","16 17 21 12 16 7"],["x1","21","y1","12","x2","9","y2","12"],[1,"main"],[1,"mobile-topbar"],[1,"icon-btn",3,"click"],["width","20","height","20","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round"],["x1","3","y1","6","x2","21","y2","6"],["x1","3","y1","12","x2","21","y2","12"],["x1","3","y1","18","x2","21","y2","18"],["class","no-chat",4,"ngIf"],["class","chat-view",4,"ngIf"],["class","backdrop",3,"click",4,"ngIf"],["class","sb-overlay",3,"click",4,"ngIf"],[1,"sb-list"],["class","empty-hint",4,"ngIf"],["class","chat-row",3,"active","click",4,"ngFor","ngForOf"],[1,"empty-hint"],["width","36","height","36","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1.2","stroke-linecap","round"],["d","M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"],[1,"chat-row",3,"click"],[1,"avatar"],["class","green-dot",4,"ngIf"],[1,"chat-row-info"],[1,"chat-row-top"],[1,"chat-row-name"],[1,"chat-row-time"],[1,"chat-row-preview"],["class","unread-dot",4,"ngIf"],[1,"unread-dot"],["class","loading-row",4,"ngIf"],["class","chat-row",3,"click",4,"ngFor","ngForOf"],[1,"loading-row"],[1,"mini-spin"],["class","chat-row-time","style","color:#22c55e",4,"ngIf"],[1,"chat-row-time",2,"color","#22c55e"],[1,"no-chat"],[1,"no-chat-box"],["width","60","height","60","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","1","stroke-linecap","round"],[1,"start-btn",3,"click"],[1,"chat-view"],[1,"chat-header"],[1,"icon-btn","back-btn",3,"click"],["points","15 18 9 12 15 6"],[1,"header-info"],[1,"header-name"],[1,"header-status"],[4,"ngIf"],[1,"header-actions"],["title","Voice call (Phase 6)",1,"icon-btn"],["width","18","height","18","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round"],["d","M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07A19.5 19.5 0 0 1 4.69 13a19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 3.6 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"],["title","Video call (Phase 6)",1,"icon-btn"],["points","23 7 16 12 23 17 23 7"],["x","1","y","5","width","15","height","14","rx","2","ry","2"],[1,"msgs-area"],[1,"msgs-inner"],["class","msgs-loading",4,"ngIf"],["class","msgs-empty",4,"ngIf"],[4,"ngFor","ngForOf"],["class","bubble-row",4,"ngIf"],[1,"input-area"],[1,"input-row"],[1,"input-box"],["type","text","placeholder","Type a message...",1,"msg-input",3,"ngModelChange","keydown.enter","input","focus","blur","ngModel","disabled"],[1,"send-btn",3,"click","disabled"],["x1","22","y1","2","x2","11","y2","13"],["points","22 2 15 22 11 13 2 9 22 2"],[1,"typing-label"],["class","online-label",4,"ngIf"],["class","offline-label",4,"ngIf"],[1,"online-label"],[1,"offline-label"],[1,"msgs-loading"],[1,"msgs-empty"],["class","date-sep",4,"ngIf"],[1,"bubble-row"],["class","avatar xs",3,"background",4,"ngIf"],[1,"bubble-wrap"],["class","sender-name",4,"ngIf"],[1,"bubble"],[1,"bubble-meta"],[1,"msg-time"],["width","14","height","14","viewBox","0 0 24 24","fill","none","stroke","#60a5fa","stroke-width","2.5","stroke-linecap","round",4,"ngIf"],[1,"date-sep"],[1,"avatar","xs"],[1,"sender-name"],["width","14","height","14","viewBox","0 0 24 24","fill","none","stroke","#60a5fa","stroke-width","2.5","stroke-linecap","round"],["points","20 6 9 17 4 12"],[1,"avatar","xs",2,"background","#2563eb"],[1,"bubble","typing-bubble"],[1,"backdrop",3,"click"],[1,"modal",3,"click"],[1,"modal-head"],["x1","18","y1","6","x2","6","y2","18"],["x1","6","y1","6","x2","18","y2","18"],[1,"modal-search"],["type","text","placeholder","Search by name or email...",1,"sb-search-input",3,"ngModelChange","ngModel"],[1,"modal-list"],["class","empty-hint sm",4,"ngIf"],[1,"empty-hint","sm"],[1,"sb-overlay",3,"click"]],template:function(n,t){if(n&1&&(a(0,"div",3)(1,"aside",4)(2,"div",5)(3,"div",6),x(),a(4,"svg",7),h(5,"path",8)(6,"circle",9)(7,"circle",10)(8,"circle",11),o(),v(),a(9,"span"),l(10,"Saylo"),o()(),a(11,"button",12),f("click",function(){return t.openNewChatModal()}),x(),a(12,"svg",13),h(13,"line",14)(14,"line",15),o()()(),v(),a(15,"div",16)(16,"div",17),x(),a(17,"svg",18),h(18,"circle",19)(19,"line",20),o(),v(),a(20,"input",21),I("ngModelChange",function(V){return T(t.searchQ,V)||(t.searchQ=V),V}),o()()(),a(21,"div",22)(22,"button",23),f("click",function(){return t.tab="chats"}),l(23,"Chats"),o(),a(24,"button",23),f("click",function(){return t.switchToPeople()}),l(25,"People"),o()(),m(26,re,3,2,"div",24)(27,he,4,3,"div",24),a(28,"div",25)(29,"div",26)(30,"div",27),l(31),h(32,"div",28),o(),a(33,"div")(34,"div",29),l(35),o(),a(36,"div",30),l(37,"Online"),o()()(),a(38,"button",31),f("click",function(){return t.logout()}),x(),a(39,"svg",32),h(40,"path",33)(41,"polyline",34)(42,"line",35),o()()()(),v(),a(43,"main",36)(44,"div",37)(45,"button",38),f("click",function(){return t.sidebarOpen=!t.sidebarOpen}),x(),a(46,"svg",39),h(47,"line",40)(48,"line",41)(49,"line",42),o()(),v(),a(50,"span"),l(51),o()(),m(52,me,10,0,"div",43)(53,Se,40,16,"div",44),o(),m(54,Ve,19,4,"div",45)(55,$e,1,0,"div",46),o()),n&2){let s;r(),C("open",t.sidebarOpen),r(19),O("ngModel",t.searchQ),r(2),C("active",t.tab==="chats"),r(2),C("active",t.tab==="people"),r(2),d("ngIf",t.tab==="chats"),r(),d("ngIf",t.tab==="people"),r(3),M("background",t.colorFor((t.me==null?null:t.me.name)||"")),r(),w(" ",t.me==null||t.me.name==null||(s=t.me.name.charAt(0))==null?null:s.toUpperCase()," "),r(4),u(t.me==null?null:t.me.name),r(16),u(t.activeChat?t.getChatName(t.activeChat):"Saylo"),r(),d("ngIf",!t.activeChat),r(),d("ngIf",t.activeChat),r(),d("ngIf",t.showModal),r(),d("ngIf",t.sidebarOpen)}},dependencies:[H,j,G,J,Y,q,R],styles:['.shell[_ngcontent-%COMP%]{display:flex;height:100vh;overflow:hidden;background:var(--bg-0);position:relative}.sidebar[_ngcontent-%COMP%]{width:300px;flex-shrink:0;background:var(--bg-1);border-right:1px solid var(--border);display:flex;flex-direction:column;overflow:hidden;z-index:10}@media (max-width: 768px){.sidebar[_ngcontent-%COMP%]{position:absolute;inset:0 auto 0 0;width:80%;max-width:300px;transform:translate(-100%);transition:transform .26s ease;box-shadow:4px 0 40px #00000080}.sidebar.open[_ngcontent-%COMP%]{transform:translate(0)}}.sb-topbar[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:16px 14px 10px;flex-shrink:0}.sb-logo[_ngcontent-%COMP%]{display:flex;align-items:center;gap:9px;font-size:17px;font-weight:800;color:var(--t1);letter-spacing:-.3px}.sb-search-wrap[_ngcontent-%COMP%]{padding:0 10px 8px;flex-shrink:0}.sb-search[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;background:var(--bg-3);border:1.5px solid var(--border);border-radius:10px;padding:0 12px;height:36px;transition:border-color .16s}.sb-search[_ngcontent-%COMP%]:focus-within{border-color:#2563eb80}.sb-search[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:var(--t3);flex-shrink:0}.sb-search-input[_ngcontent-%COMP%]{flex:1;background:none;border:none;outline:none;color:var(--t1);font-size:13px}.sb-search-input[_ngcontent-%COMP%]::placeholder{color:var(--t3)}.sb-tabs[_ngcontent-%COMP%]{display:flex;padding:0 10px 6px;gap:4px;flex-shrink:0}.sb-tab[_ngcontent-%COMP%]{flex:1;height:30px;background:none;border:none;border-radius:8px;color:var(--t3);font-size:13px;font-weight:600;cursor:pointer;transition:all .15s}.sb-tab.active[_ngcontent-%COMP%]{background:#2563eb1f;color:#60a5fa}.sb-tab[_ngcontent-%COMP%]:hover:not(.active){background:var(--bg-3);color:var(--t2)}.sb-list[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:2px 0}.chat-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:11px;padding:9px 12px;cursor:pointer;border-radius:10px;margin:0 6px;transition:background .15s}.chat-row[_ngcontent-%COMP%]:hover{background:var(--bg-3)}.chat-row.active[_ngcontent-%COMP%]{background:#2563eb1a}.chat-row.active[_ngcontent-%COMP%]   .chat-row-name[_ngcontent-%COMP%]{color:#60a5fa}.chat-row-info[_ngcontent-%COMP%]{flex:1;min-width:0}.chat-row-top[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:6px}.chat-row-name[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:var(--t1);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.chat-row-time[_ngcontent-%COMP%]{font-size:11px;color:var(--t3);flex-shrink:0}.chat-row-preview[_ngcontent-%COMP%]{font-size:12px;color:var(--t2);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.unread-dot[_ngcontent-%COMP%]{background:var(--blue);color:#fff;font-size:10px;font-weight:700;min-width:17px;height:17px;border-radius:99px;display:flex;align-items:center;justify-content:center;padding:0 4px;flex-shrink:0}.avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:15px;font-weight:700;color:#fff;flex-shrink:0;position:relative}.avatar.sm[_ngcontent-%COMP%]{width:32px;height:32px;font-size:12px}.avatar.xs[_ngcontent-%COMP%]{width:26px;height:26px;font-size:10px;margin-bottom:18px}.green-dot[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0;width:9px;height:9px;background:#22c55e;border:2px solid var(--bg-1);border-radius:50%}.empty-hint[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px 20px;text-align:center;color:var(--t3);gap:6px}.empty-hint[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:var(--t2)}.empty-hint[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:12px}.empty-hint.sm[_ngcontent-%COMP%]{padding:20px}.loading-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:14px;color:var(--t2);font-size:13px}.mini-spin[_ngcontent-%COMP%]{width:14px;height:14px;border:2px solid var(--border);border-top-color:var(--blue);border-radius:50%;animation:_ngcontent-%COMP%_spin .7s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.sb-footer[_ngcontent-%COMP%]{padding:10px 12px;border-top:1px solid var(--border);display:flex;align-items:center;justify-content:space-between;flex-shrink:0}.sb-profile[_ngcontent-%COMP%]{display:flex;align-items:center;gap:9px}.sb-profile-name[_ngcontent-%COMP%]{font-size:13px;font-weight:700;color:var(--t1)}.sb-profile-status[_ngcontent-%COMP%]{font-size:11px;color:#22c55e}.icon-btn[_ngcontent-%COMP%]{width:32px;height:32px;background:none;border:none;border-radius:8px;color:var(--t2);display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .15s}.icon-btn[_ngcontent-%COMP%]:hover{background:var(--bg-3);color:var(--t1)}.icon-btn.red-hover[_ngcontent-%COMP%]:hover{background:#ef44441a;color:#f87171}.main[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow:hidden;min-width:0}.mobile-topbar[_ngcontent-%COMP%]{display:none;align-items:center;gap:12px;padding:0 14px;height:52px;background:var(--bg-1);border-bottom:1px solid var(--border);font-size:15px;font-weight:700;color:var(--t1);flex-shrink:0}@media (max-width: 768px){.mobile-topbar[_ngcontent-%COMP%]{display:flex}}.no-chat[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center}.no-chat-box[_ngcontent-%COMP%]{text-align:center;color:var(--t3);display:flex;flex-direction:column;align-items:center;gap:10px}.no-chat-box[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{margin-bottom:8px}.no-chat-box[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:var(--t2)}.no-chat-box[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px;margin-bottom:8px}.start-btn[_ngcontent-%COMP%]{background:#2563eb1a;border:1px solid rgba(37,99,235,.3);color:#60a5fa;padding:9px 20px;border-radius:99px;font-size:14px;font-weight:600;cursor:pointer;transition:all .16s}.start-btn[_ngcontent-%COMP%]:hover{background:#2563eb2e}.chat-view[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow:hidden}.chat-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:10px 16px;background:var(--bg-1);border-bottom:1px solid var(--border);flex-shrink:0}.back-btn[_ngcontent-%COMP%]{display:none}@media (max-width: 768px){.back-btn[_ngcontent-%COMP%]{display:flex}}.header-info[_ngcontent-%COMP%]{flex:1;min-width:0}.header-name[_ngcontent-%COMP%]{font-size:15px;font-weight:700;color:var(--t1);display:block}.header-status[_ngcontent-%COMP%]{font-size:12px}.typing-label[_ngcontent-%COMP%]{color:#60a5fa;font-style:italic}.online-label[_ngcontent-%COMP%]{color:#22c55e}.offline-label[_ngcontent-%COMP%]{color:var(--t3)}.header-actions[_ngcontent-%COMP%]{display:flex;gap:2px}.msgs-area[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:0 16px}.msgs-inner[_ngcontent-%COMP%]{max-width:780px;margin:0 auto;padding:20px 0;display:flex;flex-direction:column;gap:2px}.msgs-loading[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:32px}.msgs-empty[_ngcontent-%COMP%]{text-align:center;color:var(--t3);padding:48px;font-size:14px}.date-sep[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin:16px 0;color:var(--t3);font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:.5px}.date-sep[_ngcontent-%COMP%]:before, .date-sep[_ngcontent-%COMP%]:after{content:"";flex:1;height:1px;background:var(--border)}.bubble-row[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:7px;animation:_ngcontent-%COMP%_msgIn .2s ease forwards}.bubble-row.mine[_ngcontent-%COMP%]{flex-direction:row-reverse}@keyframes _ngcontent-%COMP%_msgIn{0%{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}.bubble-wrap[_ngcontent-%COMP%]{max-width:65%;display:flex;flex-direction:column}.bubble-row.mine[_ngcontent-%COMP%]   .bubble-wrap[_ngcontent-%COMP%]{align-items:flex-end}.sender-name[_ngcontent-%COMP%]{font-size:11px;font-weight:600;color:var(--t3);margin-bottom:3px;padding-left:2px}.bubble[_ngcontent-%COMP%]{background:var(--bg-3);border:1px solid var(--border);border-radius:16px 16px 16px 4px;padding:9px 13px;font-size:14px;line-height:1.5;color:var(--t1);word-break:break-word}.bubble.mine-bubble[_ngcontent-%COMP%]{background:linear-gradient(135deg,#2563eb,#1d4ed8);border-color:transparent;border-radius:16px 16px 4px}.bubble.deleted[_ngcontent-%COMP%]{color:var(--t3);font-style:italic}.bubble-meta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;margin-top:3px;padding:0 3px}.bubble-meta.mine-meta[_ngcontent-%COMP%]{justify-content:flex-end}.msg-time[_ngcontent-%COMP%]{font-size:10px;color:var(--t3)}.typing-bubble[_ngcontent-%COMP%]{display:flex;gap:5px;align-items:center;padding:10px 14px}.typing-bubble[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;width:7px;height:7px;background:var(--t2);border-radius:50%;animation:_ngcontent-%COMP%_bounce 1.2s infinite}.typing-bubble[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){animation-delay:.2s}.typing-bubble[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(3){animation-delay:.4s}@keyframes _ngcontent-%COMP%_bounce{0%,60%,to{transform:translateY(0)}30%{transform:translateY(-6px)}}.input-area[_ngcontent-%COMP%]{padding:10px 16px 14px;background:var(--bg-1);border-top:1px solid var(--border);flex-shrink:0}.input-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;max-width:780px;margin:0 auto}.input-box[_ngcontent-%COMP%]{flex:1;background:var(--bg-3);border:1.5px solid var(--border);border-radius:99px;height:44px;display:flex;align-items:center;transition:border-color .18s,box-shadow .18s}.input-box.focused[_ngcontent-%COMP%]{border-color:var(--blue);box-shadow:0 0 0 3px #2563eb1f}.msg-input[_ngcontent-%COMP%]{flex:1;background:none;border:none;outline:none;color:var(--t1);font-size:14px;padding:0 16px;height:100%;font-family:Plus Jakarta Sans,sans-serif}.msg-input[_ngcontent-%COMP%]::placeholder{color:var(--t3)}.send-btn[_ngcontent-%COMP%]{width:44px;height:44px;border-radius:50%;background:var(--blue);border:none;color:#fff;display:flex;align-items:center;justify-content:center;cursor:pointer;flex-shrink:0;transition:all .18s;box-shadow:0 2px 10px #2563eb66}.send-btn[_ngcontent-%COMP%]:hover:not(:disabled){background:#1d4ed8;transform:scale(1.06)}.send-btn[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed;transform:none}.backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background:#000000a6;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:200}.modal[_ngcontent-%COMP%]{background:var(--bg-2);border:1px solid var(--border);border-radius:18px;width:90%;max-width:400px;max-height:65vh;display:flex;flex-direction:column;overflow:hidden;animation:_ngcontent-%COMP%_fadeUp .2s ease forwards}@keyframes _ngcontent-%COMP%_fadeUp{0%{opacity:0;transform:translateY(14px)}to{opacity:1;transform:translateY(0)}}.modal-head[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:16px 16px 10px;border-bottom:1px solid var(--border);flex-shrink:0}.modal-head[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:15px;font-weight:700;color:var(--t1)}.modal-search[_ngcontent-%COMP%]{padding:10px 14px;flex-shrink:0}.modal-list[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:4px 0 8px}.sb-overlay[_ngcontent-%COMP%]{display:none;position:fixed;inset:0;z-index:9;background:#0006}@media (max-width: 768px){.sb-overlay[_ngcontent-%COMP%]{display:block}}']})}}return i})();export{He as ChatComponent};
