import{a as Mt,c as Tt,e as Pt,j as Et}from"./chunk-R6UZD5DC.js";import{$ as c,A as E,Aa as wt,C as mt,D as gt,Da as kt,Ea as Ae,Fa as St,H as _t,I as l,J as F,O as G,P as w,R as y,S as We,T as I,U as M,V as ke,W as b,Wa as Re,X as Se,Xa as Ot,Y as U,Ya as At,Z as j,Za as Rt,_ as s,a as W,aa as f,b as pt,ba as P,ca as C,da as d,ea as J,fa as X,ga as Z,h as O,ha as xt,i as ce,ia as p,ja as g,ka as ne,l as te,la as Ct,ma as Oe,na as Me,o as Q,oa as Te,p as ht,qa as Pe,r as we,ra as bt,sa as Ee,ta as vt,u as ut,ua as Ge,v as ft,wa as yt,x as _,y as x,ya as le,z as v,za as Ye}from"./chunk-YM6L5LQP.js";import{a as R,b as V,d as gn,e as L}from"./chunk-2H7K6JAD.js";function de(i,n){!n?.injector&&ft(de);let e=n?.injector??ht(mt),t=new pt(1),r=wt(()=>{let o;try{o=i()}catch(a){Ye(()=>t.error(a));return}Ye(()=>t.next(o))},{injector:e,manualCleanup:!0});return e.get(gt).onDestroy(()=>{r.destroy(),t.complete()}),t.asObservable()}var D=Object.create(null);D.open="0";D.close="1";D.ping="2";D.pong="3";D.message="4";D.upgrade="5";D.noop="6";var pe=Object.create(null);Object.keys(D).forEach(i=>{pe[D[i]]=i});var he={type:"error",data:"parser error"};var Nt=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",It=typeof ArrayBuffer=="function",Ft=i=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(i):i&&i.buffer instanceof ArrayBuffer,ue=({type:i,data:n},e,t)=>Nt&&n instanceof Blob?e?t(n):Vt(n,t):It&&(n instanceof ArrayBuffer||Ft(n))?e?t(n):Vt(new Blob([n]),t):t(D[i]+(n||"")),Vt=(i,n)=>{let e=new FileReader;return e.onload=function(){let t=e.result.split(",")[1];n("b"+(t||""))},e.readAsDataURL(i)};function Bt(i){return i instanceof Uint8Array?i:i instanceof ArrayBuffer?new Uint8Array(i):new Uint8Array(i.buffer,i.byteOffset,i.byteLength)}var Ke;function Dt(i,n){if(Nt&&i.data instanceof Blob)return i.data.arrayBuffer().then(Bt).then(n);if(It&&(i.data instanceof ArrayBuffer||Ft(i.data)))return n(Bt(i.data));ue(i,!1,e=>{Ke||(Ke=new TextEncoder),n(Ke.encode(e))})}var zt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",fe=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let i=0;i<zt.length;i++)fe[zt.charCodeAt(i)]=i;var Lt=i=>{let n=i.length*.75,e=i.length,t,r=0,o,a,h,u;i[i.length-1]==="="&&(n--,i[i.length-2]==="="&&n--);let S=new ArrayBuffer(n),T=new Uint8Array(S);for(t=0;t<e;t+=4)o=fe[i.charCodeAt(t)],a=fe[i.charCodeAt(t+1)],h=fe[i.charCodeAt(t+2)],u=fe[i.charCodeAt(t+3)],T[r++]=o<<2|a>>4,T[r++]=(a&15)<<4|h>>2,T[r++]=(h&3)<<6|u&63;return S};var _n=typeof ArrayBuffer=="function",me=(i,n)=>{if(typeof i!="string")return{type:"message",data:Ut(i,n)};let e=i.charAt(0);return e==="b"?{type:"message",data:xn(i.substring(1),n)}:pe[e]?i.length>1?{type:pe[e],data:i.substring(1)}:{type:pe[e]}:he},xn=(i,n)=>{if(_n){let e=Lt(i);return Ut(e,n)}else return{base64:!0,data:i}},Ut=(i,n)=>{switch(n){case"blob":return i instanceof Blob?i:new Blob([i]);case"arraybuffer":default:return i instanceof ArrayBuffer?i:i.buffer}};var jt="",qt=(i,n)=>{let e=i.length,t=new Array(e),r=0;i.forEach((o,a)=>{ue(o,!1,h=>{t[a]=h,++r===e&&n(t.join(jt))})})},$t=(i,n)=>{let e=i.split(jt),t=[];for(let r=0;r<e.length;r++){let o=me(e[r],n);if(t.push(o),o.type==="error")break}return t};function Ht(){return new TransformStream({transform(i,n){Dt(i,e=>{let t=e.length,r;if(t<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,t);else if(t<65536){r=new Uint8Array(3);let o=new DataView(r.buffer);o.setUint8(0,126),o.setUint16(1,t)}else{r=new Uint8Array(9);let o=new DataView(r.buffer);o.setUint8(0,127),o.setBigUint64(1,BigInt(t))}i.data&&typeof i.data!="string"&&(r[0]|=128),n.enqueue(r),n.enqueue(e)})}})}var Qe;function Ve(i){return i.reduce((n,e)=>n+e.length,0)}function Be(i,n){if(i[0].length===n)return i.shift();let e=new Uint8Array(n),t=0;for(let r=0;r<n;r++)e[r]=i[0][t++],t===i[0].length&&(i.shift(),t=0);return i.length&&t<i[0].length&&(i[0]=i[0].slice(t)),e}function Wt(i,n){Qe||(Qe=new TextDecoder);let e=[],t=0,r=-1,o=!1;return new TransformStream({transform(a,h){for(e.push(a);;){if(t===0){if(Ve(e)<1)break;let u=Be(e,1);o=(u[0]&128)===128,r=u[0]&127,r<126?t=3:r===126?t=1:t=2}else if(t===1){if(Ve(e)<2)break;let u=Be(e,2);r=new DataView(u.buffer,u.byteOffset,u.length).getUint16(0),t=3}else if(t===2){if(Ve(e)<8)break;let u=Be(e,8),S=new DataView(u.buffer,u.byteOffset,u.length),T=S.getUint32(0);if(T>Math.pow(2,21)-1){h.enqueue(he);break}r=T*Math.pow(2,32)+S.getUint32(4),t=3}else{if(Ve(e)<r)break;let u=Be(e,r);h.enqueue(me(o?u:Qe.decode(u),n)),t=0}if(r===0||r>i){h.enqueue(he);break}}}})}var Je=4;function k(i){if(i)return Cn(i)}function Cn(i){for(var n in k.prototype)i[n]=k.prototype[n];return i}k.prototype.on=k.prototype.addEventListener=function(i,n){return this._callbacks=this._callbacks||{},(this._callbacks["$"+i]=this._callbacks["$"+i]||[]).push(n),this};k.prototype.once=function(i,n){function e(){this.off(i,e),n.apply(this,arguments)}return e.fn=n,this.on(i,e),this};k.prototype.off=k.prototype.removeListener=k.prototype.removeAllListeners=k.prototype.removeEventListener=function(i,n){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var e=this._callbacks["$"+i];if(!e)return this;if(arguments.length==1)return delete this._callbacks["$"+i],this;for(var t,r=0;r<e.length;r++)if(t=e[r],t===n||t.fn===n){e.splice(r,1);break}return e.length===0&&delete this._callbacks["$"+i],this};k.prototype.emit=function(i){this._callbacks=this._callbacks||{};for(var n=new Array(arguments.length-1),e=this._callbacks["$"+i],t=1;t<arguments.length;t++)n[t-1]=arguments[t];if(e){e=e.slice(0);for(var t=0,r=e.length;t<r;++t)e[t].apply(this,n)}return this};k.prototype.emitReserved=k.prototype.emit;k.prototype.listeners=function(i){return this._callbacks=this._callbacks||{},this._callbacks["$"+i]||[]};k.prototype.hasListeners=function(i){return!!this.listeners(i).length};var q=typeof Promise=="function"&&typeof Promise.resolve=="function"?n=>Promise.resolve().then(n):(n,e)=>e(n,0),B=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),Gt="arraybuffer";function Ne(i,...n){return n.reduce((e,t)=>(i.hasOwnProperty(t)&&(e[t]=i[t]),e),{})}var bn=B.setTimeout,vn=B.clearTimeout;function $(i,n){n.useNativeTimers?(i.setTimeoutFn=bn.bind(B),i.clearTimeoutFn=vn.bind(B)):(i.setTimeoutFn=B.setTimeout.bind(B),i.clearTimeoutFn=B.clearTimeout.bind(B))}var yn=1.33;function Yt(i){return typeof i=="string"?wn(i):Math.ceil((i.byteLength||i.size)*yn)}function wn(i){let n=0,e=0;for(let t=0,r=i.length;t<r;t++)n=i.charCodeAt(t),n<128?e+=1:n<2048?e+=2:n<55296||n>=57344?e+=3:(t++,e+=4);return e}function Ie(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Kt(i){let n="";for(let e in i)i.hasOwnProperty(e)&&(n.length&&(n+="&"),n+=encodeURIComponent(e)+"="+encodeURIComponent(i[e]));return n}function Qt(i){let n={},e=i.split("&");for(let t=0,r=e.length;t<r;t++){let o=e[t].split("=");n[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return n}var Fe=class extends Error{constructor(n,e,t){super(n),this.description=e,this.context=t,this.type="TransportError"}},H=class extends k{constructor(n){super(),this.writable=!1,$(this,n),this.opts=n,this.query=n.query,this.socket=n.socket,this.supportsBinary=!n.forceBase64}onError(n,e,t){return super.emitReserved("error",new Fe(n,e,t)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(n){this.readyState==="open"&&this.write(n)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(n){let e=me(n,this.socket.binaryType);this.onPacket(e)}onPacket(n){super.emitReserved("packet",n)}onClose(n){this.readyState="closed",super.emitReserved("close",n)}pause(n){}createUri(n,e={}){return n+"://"+this._hostname()+this._port()+this.opts.path+this._query(e)}_hostname(){let n=this.opts.hostname;return n.indexOf(":")===-1?n:"["+n+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(this.opts.port)!==443||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(n){let e=Kt(n);return e.length?"?"+e:""}};var ge=class extends H{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(n){this.readyState="pausing";let e=()=>{this.readyState="paused",n()};if(this._polling||!this.writable){let t=0;this._polling&&(t++,this.once("pollComplete",function(){--t||e()})),this.writable||(t++,this.once("drain",function(){--t||e()}))}else e()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(n){let e=t=>{if(this.readyState==="opening"&&t.type==="open"&&this.onOpen(),t.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(t)};$t(n,this.socket.binaryType).forEach(e),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){let n=()=>{this.write([{type:"close"}])};this.readyState==="open"?n():this.once("open",n)}write(n){this.writable=!1,qt(n,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let n=this.opts.secure?"https":"http",e=this.query||{};return this.opts.timestampRequests!==!1&&(e[this.opts.timestampParam]=Ie()),!this.supportsBinary&&!e.sid&&(e.b64=1),this.createUri(n,e)}};var Jt=!1;try{Jt=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}var Xt=Jt;function kn(){}var Xe=class extends ge{constructor(n){if(super(n),typeof location<"u"){let e=location.protocol==="https:",t=location.port;t||(t=e?"443":"80"),this.xd=typeof location<"u"&&n.hostname!==location.hostname||t!==n.port}}doWrite(n,e){let t=this.request({method:"POST",data:n});t.on("success",e),t.on("error",(r,o)=>{this.onError("xhr post error",r,o)})}doPoll(){let n=this.request();n.on("data",this.onData.bind(this)),n.on("error",(e,t)=>{this.onError("xhr poll error",e,t)}),this.pollXhr=n}},De=(()=>{class i extends k{constructor(e,t,r){super(),this.createRequest=e,$(this,r),this._opts=r,this._method=r.method||"GET",this._uri=t,this._data=r.data!==void 0?r.data:null,this._create()}_create(){var e;let t=Ne(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;let r=this._xhr=this.createRequest(t);try{r.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){r.setDisableHeaderCheck&&r.setDisableHeaderCheck(!0);for(let o in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(o)&&r.setRequestHeader(o,this._opts.extraHeaders[o])}}catch{}if(this._method==="POST")try{r.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{r.setRequestHeader("Accept","*/*")}catch{}(e=this._opts.cookieJar)===null||e===void 0||e.addCookies(r),"withCredentials"in r&&(r.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(r.timeout=this._opts.requestTimeout),r.onreadystatechange=()=>{var o;r.readyState===3&&((o=this._opts.cookieJar)===null||o===void 0||o.parseCookies(r.getResponseHeader("set-cookie"))),r.readyState===4&&(r.status===200||r.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof r.status=="number"?r.status:0)},0))},r.send(this._data)}catch(o){this.setTimeoutFn(()=>{this._onError(o)},0);return}typeof document<"u"&&(this._index=i.requestsCount++,i.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=kn,e)try{this._xhr.abort()}catch{}typeof document<"u"&&delete i.requests[this._index],this._xhr=null}}_onLoad(){let e=this._xhr.responseText;e!==null&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}return i.requestsCount=0,i.requests={},i})();if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Zt);else if(typeof addEventListener=="function"){let i="onpagehide"in B?"pagehide":"unload";addEventListener(i,Zt,!1)}}function Zt(){for(let i in De.requests)De.requests.hasOwnProperty(i)&&De.requests[i].abort()}var Sn=function(){let i=en({xdomain:!1});return i&&i.responseType!==null}(),Y=class extends Xe{constructor(n){super(n);let e=n&&n.forceBase64;this.supportsBinary=Sn&&!e}request(n={}){return Object.assign(n,{xd:this.xd},this.opts),new De(en,this.uri(),n)}};function en(i){let n=i.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!n||Xt))return new XMLHttpRequest}catch{}if(!n)try{return new B[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}var tn=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative",et=class extends H{get name(){return"websocket"}doOpen(){let n=this.uri(),e=this.opts.protocols,t=tn?{}:Ne(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(t.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(n,e,t)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=n=>this.onClose({description:"websocket connection closed",context:n}),this.ws.onmessage=n=>this.onData(n.data),this.ws.onerror=n=>this.onError("websocket error",n)}write(n){this.writable=!1;for(let e=0;e<n.length;e++){let t=n[e],r=e===n.length-1;ue(t,this.supportsBinary,o=>{try{this.doWrite(t,o)}catch{}r&&q(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){let n=this.opts.secure?"wss":"ws",e=this.query||{};return this.opts.timestampRequests&&(e[this.opts.timestampParam]=Ie()),this.supportsBinary||(e.b64=1),this.createUri(n,e)}},Ze=B.WebSocket||B.MozWebSocket,K=class extends et{createSocket(n,e,t){return tn?new Ze(n,e,t):e?new Ze(n,e):new Ze(n)}doWrite(n,e){this.ws.send(e)}};var ie=class extends H{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(n){return this.emitReserved("error",n)}this._transport.closed.then(()=>{this.onClose()}).catch(n=>{this.onError("webtransport error",n)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(n=>{let e=Wt(Number.MAX_SAFE_INTEGER,this.socket.binaryType),t=n.readable.pipeThrough(e).getReader(),r=Ht();r.readable.pipeTo(n.writable),this._writer=r.writable.getWriter();let o=()=>{t.read().then(({done:h,value:u})=>{h||(this.onPacket(u),o())}).catch(h=>{})};o();let a={type:"open"};this.query.sid&&(a.data=`{"sid":"${this.query.sid}"}`),this._writer.write(a).then(()=>this.onOpen())})})}write(n){this.writable=!1;for(let e=0;e<n.length;e++){let t=n[e],r=e===n.length-1;this._writer.write(t).then(()=>{r&&q(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var n;(n=this._transport)===null||n===void 0||n.close()}};var tt={websocket:K,webtransport:ie,polling:Y};var On=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,Mn=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function re(i){if(i.length>8e3)throw"URI too long";let n=i,e=i.indexOf("["),t=i.indexOf("]");e!=-1&&t!=-1&&(i=i.substring(0,e)+i.substring(e,t).replace(/:/g,";")+i.substring(t,i.length));let r=On.exec(i||""),o={},a=14;for(;a--;)o[Mn[a]]=r[a]||"";return e!=-1&&t!=-1&&(o.source=n,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=Tn(o,o.path),o.queryKey=Pn(o,o.query),o}function Tn(i,n){let e=/\/{2,9}/g,t=n.replace(e,"/").split("/");return(n.slice(0,1)=="/"||n.length===0)&&t.splice(0,1),n.slice(-1)=="/"&&t.splice(t.length-1,1),t}function Pn(i,n){let e={};return n.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(t,r,o){r&&(e[r]=o)}),e}var nt=typeof addEventListener=="function"&&typeof removeEventListener=="function",ze=[];nt&&addEventListener("offline",()=>{ze.forEach(i=>i())},!1);var Le=(()=>{class i extends k{constructor(e,t){if(super(),this.binaryType=Gt,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&typeof e=="object"&&(t=e,e=null),e){let r=re(e);t.hostname=r.host,t.secure=r.protocol==="https"||r.protocol==="wss",t.port=r.port,r.query&&(t.query=r.query)}else t.host&&(t.hostname=re(t.host).host);$(this,t),this.secure=t.secure!=null?t.secure:typeof location<"u"&&location.protocol==="https:",t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=t.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(r=>{let o=r.prototype.name;this.transports.push(o),this._transportsByName[o]=r}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Qt(this.opts.query)),nt&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},ze.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){let t=Object.assign({},this.opts.query);t.EIO=Je,t.transport=e,this.id&&(t.sid=this.id);let r=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](r)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}let e=this.opts.rememberUpgrade&&i.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";let t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",i.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(e){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":let t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data);break}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);let e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let r=0;r<this.writeBuffer.length;r++){let o=this.writeBuffer[r].data;if(o&&(t+=Yt(o)),r>0&&t>this._maxPayload)return this.writeBuffer.slice(0,r);t+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;let e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,q(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,r){return this._sendPacket("message",e,t,r),this}send(e,t,r){return this._sendPacket("message",e,t,r),this}_sendPacket(e,t,r,o){if(typeof t=="function"&&(o=t,t=void 0),typeof r=="function"&&(o=r,r=null),this.readyState==="closing"||this.readyState==="closed")return;r=r||{},r.compress=r.compress!==!1;let a={type:e,data:t,options:r};this.emitReserved("packetCreate",a),this.writeBuffer.push(a),o&&this.once("flush",o),this.flush()}close(){let e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},r=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():e()}):this.upgrading?r():e()),this}_onError(e){if(i.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),nt&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){let r=ze.indexOf(this._offlineEventListener);r!==-1&&ze.splice(r,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}return i.protocol=Je,i})(),Ue=class extends Le{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let n=0;n<this._upgrades.length;n++)this._probe(this._upgrades[n])}_probe(n){let e=this.createTransport(n),t=!1;Le.priorWebsocketSuccess=!1;let r=()=>{t||(e.send([{type:"ping",data:"probe"}]),e.once("packet",A=>{if(!t)if(A.type==="pong"&&A.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;Le.priorWebsocketSuccess=e.name==="websocket",this.transport.pause(()=>{t||this.readyState!=="closed"&&(T(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())})}else{let z=new Error("probe error");z.transport=e.name,this.emitReserved("upgradeError",z)}}))};function o(){t||(t=!0,T(),e.close(),e=null)}let a=A=>{let z=new Error("probe error: "+A);z.transport=e.name,o(),this.emitReserved("upgradeError",z)};function h(){a("transport closed")}function u(){a("socket closed")}function S(A){e&&A.name!==e.name&&o()}let T=()=>{e.removeListener("open",r),e.removeListener("error",a),e.removeListener("close",h),this.off("close",u),this.off("upgrading",S)};e.once("open",r),e.once("error",a),e.once("close",h),this.once("close",u),this.once("upgrading",S),this._upgrades.indexOf("webtransport")!==-1&&n!=="webtransport"?this.setTimeoutFn(()=>{t||e.open()},200):e.open()}onHandshake(n){this._upgrades=this._filterUpgrades(n.upgrades),super.onHandshake(n)}_filterUpgrades(n){let e=[];for(let t=0;t<n.length;t++)~this.transports.indexOf(n[t])&&e.push(n[t]);return e}},oe=class extends Ue{constructor(n,e={}){let t=typeof n=="object"?n:e;(!t.transports||t.transports&&typeof t.transports[0]=="string")&&(t.transports=(t.transports||["polling","websocket","webtransport"]).map(r=>tt[r]).filter(r=>!!r)),super(n,t)}};var no=oe.protocol;function nn(i,n="",e){let t=i;e=e||typeof location<"u"&&location,i==null&&(i=e.protocol+"//"+e.host),typeof i=="string"&&(i.charAt(0)==="/"&&(i.charAt(1)==="/"?i=e.protocol+i:i=e.host+i),/^(https?|wss?):\/\//.test(i)||(typeof e<"u"?i=e.protocol+"//"+i:i="https://"+i),t=re(i)),t.port||(/^(http|ws)$/.test(t.protocol)?t.port="80":/^(http|ws)s$/.test(t.protocol)&&(t.port="443")),t.path=t.path||"/";let o=t.host.indexOf(":")!==-1?"["+t.host+"]":t.host;return t.id=t.protocol+"://"+o+":"+t.port+n,t.href=t.protocol+"://"+o+(e&&e.port===t.port?"":":"+t.port),t}var ct={};gn(ct,{Decoder:()=>st,Encoder:()=>ot,PacketType:()=>m,isPacketValid:()=>zn,protocol:()=>cn});var An=typeof ArrayBuffer=="function",Rn=i=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(i):i.buffer instanceof ArrayBuffer,rn=Object.prototype.toString,Vn=typeof Blob=="function"||typeof Blob<"u"&&rn.call(Blob)==="[object BlobConstructor]",Bn=typeof File=="function"||typeof File<"u"&&rn.call(File)==="[object FileConstructor]";function xe(i){return An&&(i instanceof ArrayBuffer||Rn(i))||Vn&&i instanceof Blob||Bn&&i instanceof File}function _e(i,n){if(!i||typeof i!="object")return!1;if(Array.isArray(i)){for(let e=0,t=i.length;e<t;e++)if(_e(i[e]))return!0;return!1}if(xe(i))return!0;if(i.toJSON&&typeof i.toJSON=="function"&&arguments.length===1)return _e(i.toJSON(),!0);for(let e in i)if(Object.prototype.hasOwnProperty.call(i,e)&&_e(i[e]))return!0;return!1}function on(i){let n=[],e=i.data,t=i;return t.data=it(e,n),t.attachments=n.length,{packet:t,buffers:n}}function it(i,n){if(!i)return i;if(xe(i)){let e={_placeholder:!0,num:n.length};return n.push(i),e}else if(Array.isArray(i)){let e=new Array(i.length);for(let t=0;t<i.length;t++)e[t]=it(i[t],n);return e}else if(typeof i=="object"&&!(i instanceof Date)){let e={};for(let t in i)Object.prototype.hasOwnProperty.call(i,t)&&(e[t]=it(i[t],n));return e}return i}function sn(i,n){return i.data=rt(i.data,n),delete i.attachments,i}function rt(i,n){if(!i)return i;if(i&&i._placeholder===!0){if(typeof i.num=="number"&&i.num>=0&&i.num<n.length)return n[i.num];throw new Error("illegal attachments")}else if(Array.isArray(i))for(let e=0;e<i.length;e++)i[e]=rt(i[e],n);else if(typeof i=="object")for(let e in i)Object.prototype.hasOwnProperty.call(i,e)&&(i[e]=rt(i[e],n));return i}var an=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],cn=5,m=function(i){return i[i.CONNECT=0]="CONNECT",i[i.DISCONNECT=1]="DISCONNECT",i[i.EVENT=2]="EVENT",i[i.ACK=3]="ACK",i[i.CONNECT_ERROR=4]="CONNECT_ERROR",i[i.BINARY_EVENT=5]="BINARY_EVENT",i[i.BINARY_ACK=6]="BINARY_ACK",i}(m||{}),ot=class{constructor(n){this.replacer=n}encode(n){return(n.type===m.EVENT||n.type===m.ACK)&&_e(n)?this.encodeAsBinary({type:n.type===m.EVENT?m.BINARY_EVENT:m.BINARY_ACK,nsp:n.nsp,data:n.data,id:n.id}):[this.encodeAsString(n)]}encodeAsString(n){let e=""+n.type;return(n.type===m.BINARY_EVENT||n.type===m.BINARY_ACK)&&(e+=n.attachments+"-"),n.nsp&&n.nsp!=="/"&&(e+=n.nsp+","),n.id!=null&&(e+=n.id),n.data!=null&&(e+=JSON.stringify(n.data,this.replacer)),e}encodeAsBinary(n){let e=on(n),t=this.encodeAsString(e.packet),r=e.buffers;return r.unshift(t),r}},st=class i extends k{constructor(n){super(),this.reviver=n}add(n){let e;if(typeof n=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(n);let t=e.type===m.BINARY_EVENT;t||e.type===m.BINARY_ACK?(e.type=t?m.EVENT:m.ACK,this.reconstructor=new at(e),e.attachments===0&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else if(xe(n)||n.base64)if(this.reconstructor)e=this.reconstructor.takeBinaryData(n),e&&(this.reconstructor=null,super.emitReserved("decoded",e));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+n)}decodeString(n){let e=0,t={type:Number(n.charAt(0))};if(m[t.type]===void 0)throw new Error("unknown packet type "+t.type);if(t.type===m.BINARY_EVENT||t.type===m.BINARY_ACK){let o=e+1;for(;n.charAt(++e)!=="-"&&e!=n.length;);let a=n.substring(o,e);if(a!=Number(a)||n.charAt(e)!=="-")throw new Error("Illegal attachments");t.attachments=Number(a)}if(n.charAt(e+1)==="/"){let o=e+1;for(;++e&&!(n.charAt(e)===","||e===n.length););t.nsp=n.substring(o,e)}else t.nsp="/";let r=n.charAt(e+1);if(r!==""&&Number(r)==r){let o=e+1;for(;++e;){let a=n.charAt(e);if(a==null||Number(a)!=a){--e;break}if(e===n.length)break}t.id=Number(n.substring(o,e+1))}if(n.charAt(++e)){let o=this.tryParse(n.substr(e));if(i.isPayloadValid(t.type,o))t.data=o;else throw new Error("invalid payload")}return t}tryParse(n){try{return JSON.parse(n,this.reviver)}catch{return!1}}static isPayloadValid(n,e){switch(n){case m.CONNECT:return je(e);case m.DISCONNECT:return e===void 0;case m.CONNECT_ERROR:return typeof e=="string"||je(e);case m.EVENT:case m.BINARY_EVENT:return Array.isArray(e)&&(typeof e[0]=="number"||typeof e[0]=="string"&&an.indexOf(e[0])===-1);case m.ACK:case m.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}},at=class{constructor(n){this.packet=n,this.buffers=[],this.reconPack=n}takeBinaryData(n){if(this.buffers.push(n),this.buffers.length===this.reconPack.attachments){let e=sn(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}};function Nn(i){return typeof i=="string"}var In=Number.isInteger||function(i){return typeof i=="number"&&isFinite(i)&&Math.floor(i)===i};function Fn(i){return i===void 0||In(i)}function je(i){return Object.prototype.toString.call(i)==="[object Object]"}function Dn(i,n){switch(i){case m.CONNECT:return n===void 0||je(n);case m.DISCONNECT:return n===void 0;case m.EVENT:return Array.isArray(n)&&(typeof n[0]=="number"||typeof n[0]=="string"&&an.indexOf(n[0])===-1);case m.ACK:return Array.isArray(n);case m.CONNECT_ERROR:return typeof n=="string"||je(n);default:return!1}}function zn(i){return Nn(i.nsp)&&Fn(i.id)&&Dn(i.type,i.data)}function N(i,n,e){return i.on(n,e),function(){i.off(n,e)}}var Ln=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),se=class extends k{constructor(n,e,t){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=n,this.nsp=e,t&&t.auth&&(this.auth=t.auth),this._opts=Object.assign({},t),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let n=this.io;this.subs=[N(n,"open",this.onopen.bind(this)),N(n,"packet",this.onpacket.bind(this)),N(n,"error",this.onerror.bind(this)),N(n,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...n){return n.unshift("message"),this.emit.apply(this,n),this}emit(n,...e){var t,r,o;if(Ln.hasOwnProperty(n))throw new Error('"'+n.toString()+'" is a reserved event name');if(e.unshift(n),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(e),this;let a={type:m.EVENT,data:e};if(a.options={},a.options.compress=this.flags.compress!==!1,typeof e[e.length-1]=="function"){let T=this.ids++,A=e.pop();this._registerAckCallback(T,A),a.id=T}let h=(r=(t=this.io.engine)===null||t===void 0?void 0:t.transport)===null||r===void 0?void 0:r.writable,u=this.connected&&!(!((o=this.io.engine)===null||o===void 0)&&o._hasPingExpired());return this.flags.volatile&&!h||(u?(this.notifyOutgoingListeners(a),this.packet(a)):this.sendBuffer.push(a)),this.flags={},this}_registerAckCallback(n,e){var t;let r=(t=this.flags.timeout)!==null&&t!==void 0?t:this._opts.ackTimeout;if(r===void 0){this.acks[n]=e;return}let o=this.io.setTimeoutFn(()=>{delete this.acks[n];for(let h=0;h<this.sendBuffer.length;h++)this.sendBuffer[h].id===n&&this.sendBuffer.splice(h,1);e.call(this,new Error("operation has timed out"))},r),a=(...h)=>{this.io.clearTimeoutFn(o),e.apply(this,h)};a.withError=!0,this.acks[n]=a}emitWithAck(n,...e){return new Promise((t,r)=>{let o=(a,h)=>a?r(a):t(h);o.withError=!0,e.push(o),this.emit(n,...e)})}_addToQueue(n){let e;typeof n[n.length-1]=="function"&&(e=n.pop());let t={id:this._queueSeq++,tryCount:0,pending:!1,args:n,flags:Object.assign({fromQueue:!0},this.flags)};n.push((r,...o)=>(this._queue[0],r!==null?t.tryCount>this._opts.retries&&(this._queue.shift(),e&&e(r)):(this._queue.shift(),e&&e(null,...o)),t.pending=!1,this._drainQueue())),this._queue.push(t),this._drainQueue()}_drainQueue(n=!1){if(!this.connected||this._queue.length===0)return;let e=this._queue[0];e.pending&&!n||(e.pending=!0,e.tryCount++,this.flags=e.flags,this.emit.apply(this,e.args))}packet(n){n.nsp=this.nsp,this.io._packet(n)}onopen(){typeof this.auth=="function"?this.auth(n=>{this._sendConnectPacket(n)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(n){this.packet({type:m.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},n):n})}onerror(n){this.connected||this.emitReserved("connect_error",n)}onclose(n,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",n,e),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(n=>{if(!this.sendBuffer.some(t=>String(t.id)===n)){let t=this.acks[n];delete this.acks[n],t.withError&&t.call(this,new Error("socket has been disconnected"))}})}onpacket(n){if(n.nsp===this.nsp)switch(n.type){case m.CONNECT:n.data&&n.data.sid?this.onconnect(n.data.sid,n.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case m.EVENT:case m.BINARY_EVENT:this.onevent(n);break;case m.ACK:case m.BINARY_ACK:this.onack(n);break;case m.DISCONNECT:this.ondisconnect();break;case m.CONNECT_ERROR:this.destroy();let t=new Error(n.data.message);t.data=n.data.data,this.emitReserved("connect_error",t);break}}onevent(n){let e=n.data||[];n.id!=null&&e.push(this.ack(n.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(n){if(this._anyListeners&&this._anyListeners.length){let e=this._anyListeners.slice();for(let t of e)t.apply(this,n)}super.emit.apply(this,n),this._pid&&n.length&&typeof n[n.length-1]=="string"&&(this._lastOffset=n[n.length-1])}ack(n){let e=this,t=!1;return function(...r){t||(t=!0,e.packet({type:m.ACK,id:n,data:r}))}}onack(n){let e=this.acks[n.id];typeof e=="function"&&(delete this.acks[n.id],e.withError&&n.data.unshift(null),e.apply(this,n.data))}onconnect(n,e){this.id=n,this.recovered=e&&this._pid===e,this._pid=e,this.connected=!0,this.emitBuffered(),this._drainQueue(!0),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach(n=>this.emitEvent(n)),this.receiveBuffer=[],this.sendBuffer.forEach(n=>{this.notifyOutgoingListeners(n),this.packet(n)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(n=>n()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:m.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(n){return this.flags.compress=n,this}get volatile(){return this.flags.volatile=!0,this}timeout(n){return this.flags.timeout=n,this}onAny(n){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(n),this}prependAny(n){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(n),this}offAny(n){if(!this._anyListeners)return this;if(n){let e=this._anyListeners;for(let t=0;t<e.length;t++)if(n===e[t])return e.splice(t,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(n){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(n),this}prependAnyOutgoing(n){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(n),this}offAnyOutgoing(n){if(!this._anyOutgoingListeners)return this;if(n){let e=this._anyOutgoingListeners;for(let t=0;t<e.length;t++)if(n===e[t])return e.splice(t,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(n){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let e=this._anyOutgoingListeners.slice();for(let t of e)t.apply(this,n.data)}}};function ee(i){i=i||{},this.ms=i.min||100,this.max=i.max||1e4,this.factor=i.factor||2,this.jitter=i.jitter>0&&i.jitter<=1?i.jitter:0,this.attempts=0}ee.prototype.duration=function(){var i=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var n=Math.random(),e=Math.floor(n*this.jitter*i);i=Math.floor(n*10)&1?i+e:i-e}return Math.min(i,this.max)|0};ee.prototype.reset=function(){this.attempts=0};ee.prototype.setMin=function(i){this.ms=i};ee.prototype.setMax=function(i){this.max=i};ee.prototype.setJitter=function(i){this.jitter=i};var ae=class extends k{constructor(n,e){var t;super(),this.nsps={},this.subs=[],n&&typeof n=="object"&&(e=n,n=void 0),e=e||{},e.path=e.path||"/socket.io",this.opts=e,$(this,e),this.reconnection(e.reconnection!==!1),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor((t=e.randomizationFactor)!==null&&t!==void 0?t:.5),this.backoff=new ee({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(e.timeout==null?2e4:e.timeout),this._readyState="closed",this.uri=n;let r=e.parser||ct;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=e.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(n){return arguments.length?(this._reconnection=!!n,n||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(n){return n===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=n,this)}reconnectionDelay(n){var e;return n===void 0?this._reconnectionDelay:(this._reconnectionDelay=n,(e=this.backoff)===null||e===void 0||e.setMin(n),this)}randomizationFactor(n){var e;return n===void 0?this._randomizationFactor:(this._randomizationFactor=n,(e=this.backoff)===null||e===void 0||e.setJitter(n),this)}reconnectionDelayMax(n){var e;return n===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=n,(e=this.backoff)===null||e===void 0||e.setMax(n),this)}timeout(n){return arguments.length?(this._timeout=n,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(n){if(~this._readyState.indexOf("open"))return this;this.engine=new oe(this.uri,this.opts);let e=this.engine,t=this;this._readyState="opening",this.skipReconnect=!1;let r=N(e,"open",function(){t.onopen(),n&&n()}),o=h=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",h),n?n(h):this.maybeReconnectOnOpen()},a=N(e,"error",o);if(this._timeout!==!1){let h=this._timeout,u=this.setTimeoutFn(()=>{r(),o(new Error("timeout")),e.close()},h);this.opts.autoUnref&&u.unref(),this.subs.push(()=>{this.clearTimeoutFn(u)})}return this.subs.push(r),this.subs.push(a),this}connect(n){return this.open(n)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");let n=this.engine;this.subs.push(N(n,"ping",this.onping.bind(this)),N(n,"data",this.ondata.bind(this)),N(n,"error",this.onerror.bind(this)),N(n,"close",this.onclose.bind(this)),N(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(n){try{this.decoder.add(n)}catch(e){this.onclose("parse error",e)}}ondecoded(n){q(()=>{this.emitReserved("packet",n)},this.setTimeoutFn)}onerror(n){this.emitReserved("error",n)}socket(n,e){let t=this.nsps[n];return t?this._autoConnect&&!t.active&&t.connect():(t=new se(this,n,e),this.nsps[n]=t),t}_destroy(n){let e=Object.keys(this.nsps);for(let t of e)if(this.nsps[t].active)return;this._close()}_packet(n){let e=this.encoder.encode(n);for(let t=0;t<e.length;t++)this.engine.write(e[t],n.options)}cleanup(){this.subs.forEach(n=>n()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(n,e){var t;this.cleanup(),(t=this.engine)===null||t===void 0||t.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",n,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let n=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let e=this.backoff.duration();this._reconnecting=!0;let t=this.setTimeoutFn(()=>{n.skipReconnect||(this.emitReserved("reconnect_attempt",n.backoff.attempts),!n.skipReconnect&&n.open(r=>{r?(n._reconnecting=!1,n.reconnect(),this.emitReserved("reconnect_error",r)):n.onreconnect()}))},e);this.opts.autoUnref&&t.unref(),this.subs.push(()=>{this.clearTimeoutFn(t)})}}onreconnect(){let n=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",n)}};var Ce={};function be(i,n){typeof i=="object"&&(n=i,i=void 0),n=n||{};let e=nn(i,n.path||"/socket.io"),t=e.source,r=e.id,o=e.path,a=Ce[r]&&o in Ce[r].nsps,h=n.forceNew||n["force new connection"]||n.multiplex===!1||a,u;return h?u=new ae(t,n):(Ce[r]||(Ce[r]=new ae(t,n)),u=Ce[r]),e.query&&!n.query&&(n.query=e.queryKey),u.socket(e.path,n)}Object.assign(be,{Manager:ae,Socket:se,io:be,connect:be});var qe=(()=>{class i{constructor(e){this.zone=e,this.socket=null,this.eventBuffer=new Map,this.isConnected=w(!1)}connect(e){this.socket?.connected||(console.log("[Socket] Connecting userId:",e),this.socket=be(Re.socketUrl,{auth:{userId:e},transports:["polling","websocket"],upgrade:!0,reconnection:!0,reconnectionAttempts:20,reconnectionDelay:1e3,reconnectionDelayMax:5e3,timeout:3e4,forceNew:!0,withCredentials:!0}),this.socket.on("connect",()=>{console.log("[Socket] \u2705 Connected:",this.socket?.id),this.zone.run(()=>this.isConnected.set(!0)),this.eventBuffer.forEach((t,r)=>{this.socket.on(r,o=>{this.zone.run(()=>t.next(o))})})}),this.socket.on("disconnect",t=>{console.log("[Socket] Disconnected:",t),this.zone.run(()=>this.isConnected.set(!1))}),this.socket.on("connect_error",t=>{console.error("[Socket] Error:",t.message)}))}on(e){this.eventBuffer.has(e)||this.eventBuffer.set(e,new W);let t=this.eventBuffer.get(e);return this.socket?.connected&&this.socket.on(e,r=>{this.zone.run(()=>t.next(r))}),t.asObservable()}emit(e,t){this.socket?.connected?this.socket.emit(e,t):console.warn("[Socket] Not connected, cannot emit:",e)}joinChat(e){this.emit("chat:join",{chatId:e}),console.log("[Socket] Joining chat:",e)}leaveChat(e){this.emit("chat:leave",{chatId:e})}sendMessage(e,t,r,o){this.emit("message:send",{chatId:e,content:t,type:r||"text",replyTo:o})}sendTypingStart(e){this.emit("typing",{chatId:e,isTyping:!0})}sendTypingStop(e){this.emit("typing",{chatId:e,isTyping:!1})}sendTyping(e,t){this.emit("typing",{chatId:e,isTyping:t})}markRead(e,t){this.emit("message:read",{chatId:e,messageIds:Array.isArray(t)?t:[t]})}reactToMessage(e,t,r){this.emit("message:react",{messageId:e,emoji:r,chatId:t})}addReaction(e,t,r){this.emit("message:react",{messageId:e,emoji:t,chatId:r})}initiateCall(e,t,r){this.emit("call:initiate",{chatId:e,targetUserId:t,type:r}),console.log("[Socket] call:initiate \u2192",{chatId:e,targetUserId:t,type:r})}answerCall(e){this.emit("call:answer",{callId:e})}declineCall(e){this.emit("call:decline",{callId:e})}endCall(e){this.emit("call:end",{callId:e})}sendOffer(e,t,r){this.emit("webrtc:offer",{callId:e,offer:t,targetUserId:r}),console.log("[Socket] webrtc:offer \u2192 ",r)}sendAnswer(e,t,r){this.emit("webrtc:answer",{callId:e,answer:t,targetUserId:r})}sendIceCandidate(e,t,r){this.emit("webrtc:ice-candidate",{callId:e,candidate:t,targetUserId:r})}disconnect(){this.socket?.disconnect(),this.socket=null,this.isConnected.set(!1),this.eventBuffer.clear()}static{this.\u0275fac=function(t){return new(t||i)(Q(G))}}static{this.\u0275prov=te({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var $e=(()=>{class i{constructor(e,t){this.socket=e,this.zone=t,this.destroy$=new W,this.pc=null,this.pendingOffer=null,this.pendingOfferFrom=null,this.durationTimer=null,this.audioElement=null,this.remoteStreamRef=new MediaStream,this.callStatus=w("idle"),this.activeCall=w(null),this.incomingCall=w(null),this.localStream=w(null),this.remoteStream=w(null),this.isMuted=w(!1),this.isCameraOff=w(!1),this.callDuration=w(0),this.pendingCallerName="",this.STUN={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"stun:stun2.l.google.com:19302"},{urls:"stun:stun3.l.google.com:19302"}]},this.listenSocket()}startCall(e,t,r,o){return L(this,null,function*(){if(this.callStatus()!=="idle"){alert("Already in a call");return}this.hardReset(!0);try{let a=yield this.getMedia(o);this.zone.run(()=>{this.localStream.set(a),this.callStatus.set("calling")}),this.socket.initiateCall(e,t,o);let h=this.socket.on("call:initiated").subscribe(S=>L(this,[S],function*({callId:u}){h.unsubscribe(),this.zone.run(()=>{this.activeCall.set({callId:u,type:o,chatId:e,remoteUserId:t,remoteUserName:r,direction:"outgoing"}),this.callStatus.set("calling")}),this.pc=this.createPC(u,t,o),this.addTracks(a,o),yield this.makeOffer(u,t,o)}))}catch(a){console.error("[Call] Start failed:",a),this.zone.run(()=>{alert(this.mediaError(a)),this.cleanup()})}})}answerCall(){return L(this,null,function*(){let e=this.incomingCall();if(e)try{let t,r=e.type;try{t=yield this.getMedia(r)}catch(o){if(r==="video")console.warn("[Call] Camera unavailable, falling back to audio:",o.message),t=yield this.getMedia("audio"),r="audio";else throw o}this.zone.run(()=>{this.localStream.set(t),this.activeCall.set(V(R({},e),{type:r,direction:"incoming"})),this.incomingCall.set(null),this.callStatus.set("connected")}),this.socket.answerCall(e.callId),this.pc=this.createPC(e.callId,e.remoteUserId,r),this.addTracks(t,r),this.pendingOffer&&this.pendingOfferFrom&&(console.log("[WebRTC] Processing buffered offer"),yield this.processOffer(e.callId,this.pendingOffer,this.pendingOfferFrom,r),this.pendingOffer=null,this.pendingOfferFrom=null),this.startTimer()}catch(t){console.error("[Call] Answer failed:",t),this.zone.run(()=>{alert(this.mediaError(t)),this.cleanup()})}})}declineCall(){let e=this.incomingCall();e&&this.socket.declineCall(e.callId),this.cleanup()}endCall(){let e=this.activeCall();e&&this.socket.endCall(e.callId),this.cleanup()}toggleMute(){let e=this.localStream();e&&(e.getAudioTracks().forEach(t=>{t.enabled=!t.enabled}),this.isMuted.set(!this.isMuted()))}toggleCamera(){let e=this.localStream();e&&(e.getVideoTracks().forEach(t=>{t.enabled=!t.enabled}),this.isCameraOff.set(!this.isCameraOff()))}getMedia(e){return L(this,null,function*(){return navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!0,noiseSuppression:!0,sampleRate:48e3},video:e==="video"?{width:{ideal:1280},height:{ideal:720},facingMode:"user",frameRate:{ideal:30}}:!1})})}addTracks(e,t){if(!this.pc)return;let r=e.getAudioTracks(),o=e.getVideoTracks();r.forEach(a=>{console.log("[WebRTC] Adding local audio track"),this.pc.addTrack(a,e)}),t==="video"&&o.forEach(a=>{console.log("[WebRTC] Adding local video track"),this.pc.addTrack(a,e)})}createPC(e,t,r){try{this.pc&&(this.pc.ontrack=null,this.pc.onicecandidate=null,this.pc.oniceconnectionstatechange=null,this.pc.onsignalingstatechange=null,this.pc.close())}catch{}this.pc=null,this.remoteStreamRef=new MediaStream,this.remoteStream.set(this.remoteStreamRef);let o=new RTCPeerConnection(this.STUN);return o.ontrack=a=>{let h=a.track;if(console.log("[WebRTC] Remote track:",h.kind,"| state:",h.readyState,"| streams:",a.streams.length),a.streams&&a.streams[0]){let u=a.streams[0];this.remoteStreamRef.getTracks().find(T=>T.id===h.id)||(this.remoteStreamRef.addTrack(h),console.log("[WebRTC] Added",h.kind,"to remoteStream. Total:",this.remoteStreamRef.getTracks().length)),h.onunmute=()=>{console.log("[WebRTC] Track unmuted:",h.kind),this.zone.run(()=>this.remoteStream.set(new MediaStream(this.remoteStreamRef.getTracks())))}}this.zone.run(()=>{let u=new MediaStream(this.remoteStreamRef.getTracks());this.remoteStream.set(u),console.log("[WebRTC] remoteStream updated. Tracks:",u.getTracks().map(S=>`${S.kind}(${S.readyState})`)),r==="audio"&&this.playAudio(u)})},o.onicecandidate=a=>{a.candidate&&this.socket.sendIceCandidate(e,a.candidate,t)},o.oniceconnectionstatechange=()=>{console.log("[WebRTC] ICE:",o.iceConnectionState),(o.iceConnectionState==="connected"||o.iceConnectionState==="completed")&&this.zone.run(()=>{this.callStatus.set("connected"),this.startTimer()}),o.iceConnectionState==="failed"&&this.zone.run(()=>{alert("Connection failed. Try again."),this.cleanup()})},o.onsignalingstatechange=()=>console.log("[WebRTC] Signaling:",o.signalingState),o}makeOffer(e,t,r){return L(this,null,function*(){if(!(!this.pc||this.pc.signalingState!=="stable"))try{let o=yield this.pc.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:r==="video"});yield this.pc.setLocalDescription(o),this.socket.sendOffer(e,o,t),console.log("[WebRTC] \u2705 Offer sent")}catch(o){console.error("[WebRTC] Offer error:",o)}})}processOffer(e,t,r,o){return L(this,null,function*(){if(this.pc)try{yield this.pc.setRemoteDescription(new RTCSessionDescription(t));let a=yield this.pc.createAnswer();yield this.pc.setLocalDescription(a),this.socket.sendAnswer(e,a,r),console.log("[WebRTC] \u2705 Answer sent")}catch(a){console.error("[WebRTC] processOffer error:",a)}})}playAudio(e){try{this.audioElement&&(this.audioElement.pause(),this.audioElement.srcObject=null),this.audioElement=new Audio,this.audioElement.srcObject=e,this.audioElement.volume=1,this.audioElement.play().then(()=>console.log("[Call] \u2705 Audio playing")).catch(t=>console.warn("[Call] Audio blocked:",t))}catch(t){console.error("[Call] Audio element error:",t)}}listenSocket(){this.socket.on("call:incoming").pipe(O(this.destroy$)).subscribe(({callId:e,from:t,fromName:r,chatId:o,type:a})=>{if(console.log("[Call] \u{1F4DE} INCOMING from:",r,"| type:",a),this.callStatus()!=="idle"){this.socket.declineCall(e);return}this.zone.run(()=>{this.incomingCall.set({callId:e,type:a,chatId:o,remoteUserId:t,remoteUserName:r||"Someone",direction:"incoming"}),this.callStatus.set("ringing")})}),this.socket.on("call:answered").pipe(O(this.destroy$)).subscribe(({callId:e})=>console.log("[Call] \u2705 Answered:",e)),this.socket.on("call:declined").pipe(O(this.destroy$)).subscribe(()=>this.zone.run(()=>{alert("Call was declined."),this.cleanup()})),this.socket.on("call:ended").pipe(O(this.destroy$)).subscribe(()=>this.zone.run(()=>this.cleanup())),this.socket.on("call:user-offline").pipe(O(this.destroy$)).subscribe(()=>this.zone.run(()=>{alert("User is offline."),this.cleanup()})),this.socket.on("webrtc:offer").pipe(O(this.destroy$)).subscribe(o=>L(this,[o],function*({callId:e,offer:t,from:r}){console.log("[WebRTC] \u{1F4E8} Offer received | PC:",this.pc?.signalingState||"no PC");let a=this.activeCall()?.type||this.incomingCall()?.type||"audio";this.pc&&this.pc.signalingState==="stable"?yield this.processOffer(e,t,r,a):(this.pendingOffer=t,this.pendingOfferFrom=r)})),this.socket.on("webrtc:answer").pipe(O(this.destroy$)).subscribe(t=>L(this,[t],function*({answer:e}){console.log("[WebRTC] \u{1F4E8} Answer received | PC:",this.pc?.signalingState);try{this.pc?.signalingState==="have-local-offer"&&(yield this.pc.setRemoteDescription(new RTCSessionDescription(e)),console.log("[WebRTC] \u2705 Remote description set"))}catch(r){console.error("[WebRTC] Set answer error:",r)}})),this.socket.on("webrtc:ice-candidate").pipe(O(this.destroy$)).subscribe(t=>L(this,[t],function*({candidate:e}){try{this.pc?.remoteDescription&&(yield this.pc.addIceCandidate(new RTCIceCandidate(e)))}catch(r){console.warn("[WebRTC] ICE warn:",r)}}))}startTimer(){this.durationTimer||(this.callDuration.set(0),this.durationTimer=setInterval(()=>this.zone.run(()=>this.callDuration.update(e=>e+1)),1e3))}hardReset(e){try{this.pc&&(this.pc.ontrack=null,this.pc.onicecandidate=null,this.pc.oniceconnectionstatechange=null,this.pc.onsignalingstatechange=null,this.pc.close())}catch{}if(this.pc=null,e){try{this.localStream()?.getTracks().forEach(t=>t.stop())}catch{}try{this.remoteStream()?.getTracks().forEach(t=>t.stop())}catch{}this.localStream.set(null),this.remoteStream.set(null),this.remoteStreamRef=new MediaStream}try{this.audioElement&&(this.audioElement.pause(),this.audioElement.srcObject=null,this.audioElement=null)}catch{}}cleanup(){clearInterval(this.durationTimer),this.durationTimer=null,this.hardReset(!0),this.pendingOffer=null,this.pendingOfferFrom=null,this.activeCall.set(null),this.incomingCall.set(null),this.callStatus.set("idle"),this.callDuration.set(0),this.isMuted.set(!1),this.isCameraOff.set(!1)}mediaError(e){return e.name==="NotAllowedError"?"Permission denied. Allow camera/mic in browser settings.":e.name==="NotFoundError"?"No camera/microphone found on this device.":"Could not access camera/mic. Close other apps using it."}destroy(){this.destroy$.next(),this.destroy$.complete(),this.cleanup()}static{this.\u0275fac=function(t){return new(t||i)(Q(qe),Q(G))}}static{this.\u0275prov=te({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var Un=["localVid"],jn=["remoteVid"];function qn(i,n){if(i&1){let e=P();s(0,"div",2)(1,"div",4),f(2,"div",5)(3,"div",6)(4,"div",7),s(5,"div",8),p(6),c(),s(7,"h2",9),p(8),c(),s(9,"p",10),p(10),c(),s(11,"div",11),f(12,"span")(13,"span")(14,"span"),c(),s(15,"div",12)(16,"button",13),C("click",function(){_(e);let r=d();return x(r.callSvc.declineCall())}),v(),s(17,"svg",14),f(18,"line",15)(19,"path",16),c()(),E(),s(20,"button",17),C("click",function(){_(e);let r=d();return x(r.callSvc.answerCall())}),v(),s(21,"svg",14),f(22,"path",18),c()()()()()}if(i&2){let e=n,t=d();l(5),I("background",t.grad(e.remoteUserName)),l(),g(t.ini(e.remoteUserName)),l(2),g(e.remoteUserName),l(2),g(e.type==="video"?"\u{1F4F9} Incoming Video Call":"\u{1F4DE} Incoming Audio Call")}}function $n(i,n){if(i&1){let e=P();s(0,"div",2)(1,"div",19)(2,"div",8),p(3),c(),s(4,"h2",9),p(5),c(),s(6,"p",10),p(7,"Calling..."),c(),s(8,"div",11),f(9,"span")(10,"span")(11,"span"),c(),s(12,"button",20),C("click",function(){_(e);let r=d();return x(r.callSvc.endCall())}),v(),s(13,"svg",21),f(14,"line",15)(15,"path",16),c(),p(16," Cancel "),c()()()}if(i&2){let e,t,r,o=d();l(2),I("background",o.grad(((e=o.callSvc.activeCall())==null?null:e.remoteUserName)||"")),l(),g(o.ini(((t=o.callSvc.activeCall())==null?null:t.remoteUserName)||"")),l(2),g((r=o.callSvc.activeCall())==null?null:r.remoteUserName)}}function Hn(i,n){if(i&1&&f(0,"div",36),i&2){let e=n.$implicit;I("animation-delay",e*.09+"s")}}function Wn(i,n){i&1&&(v(),s(0,"svg",29),f(1,"line",15)(2,"path",37)(3,"path",38)(4,"line",39),c())}function Gn(i,n){i&1&&(v(),s(0,"svg",29),f(1,"path",40)(2,"path",41)(3,"line",39),c())}function Yn(i,n){if(i&1){let e=P();s(0,"div",2)(1,"div",22)(2,"div",23),U(3,Hn,1,2,"div",24,Se),c(),s(5,"div",25),p(6),c(),s(7,"h2",9),p(8),c(),s(9,"p",26),p(10),c(),s(11,"div",27)(12,"button",28),C("click",function(){_(e);let r=d();return x(r.callSvc.toggleMute())}),y(13,Wn,5,0,":svg:svg",29)(14,Gn,4,0),s(15,"span"),p(16),c()(),s(17,"button",30),C("click",function(){_(e);let r=d();return x(r.callSvc.endCall())}),v(),s(18,"svg",31),f(19,"line",15)(20,"path",16),c(),E(),s(21,"span"),p(22,"End"),c()(),s(23,"button",32),v(),s(24,"svg",29),f(25,"polygon",33)(26,"path",34)(27,"path",35),c(),E(),s(28,"span"),p(29,"Speaker"),c()()()()()}if(i&2){let e=d();l(2),M("muted",e.callSvc.isMuted()),l(),j(e.bars),l(2),I("background",e.grad(e.callSvc.activeCall().remoteUserName)),l(),g(e.ini(e.callSvc.activeCall().remoteUserName)),l(2),g(e.callSvc.activeCall().remoteUserName),l(2),g(e.fmt(e.callSvc.callDuration())),l(2),M("on",e.callSvc.isMuted()),l(),b(13,e.callSvc.isMuted()?13:14),l(3),g(e.callSvc.isMuted()?"Unmute":"Mute")}}function Kn(i,n){if(i&1&&(s(0,"div",43)(1,"div",59),p(2),c(),s(3,"p",60),p(4),c(),s(5,"p",61),p(6,"Connecting video..."),c()()),i&2){let e=d(2);l(),I("background",e.grad(e.callSvc.activeCall().remoteUserName)),l(),g(e.ini(e.callSvc.activeCall().remoteUserName)),l(2),g(e.callSvc.activeCall().remoteUserName)}}function Qn(i,n){i&1&&(s(0,"div",46),v(),s(1,"svg",62),f(2,"line",15)(3,"path",63),c()())}function Jn(i,n){i&1&&(v(),s(0,"svg",29),f(1,"line",15)(2,"path",37),c())}function Xn(i,n){i&1&&(v(),s(0,"svg",29),f(1,"path",40)(2,"path",41),c())}function Zn(i,n){i&1&&(v(),s(0,"svg",29),f(1,"line",15)(2,"path",63),c())}function ei(i,n){i&1&&(v(),s(0,"svg",29),f(1,"path",64),c())}function ti(i,n){if(i&1){let e=P();s(0,"div",3),f(1,"video",42,0),y(3,Kn,7,4,"div",43),s(4,"div",44),f(5,"video",45,1),y(7,Qn,4,0,"div",46),c(),s(8,"div",47)(9,"div")(10,"div",48),p(11),c(),s(12,"div",49),p(13),c()(),s(14,"div",50),f(15,"div",51)(16,"div",52)(17,"div",53)(18,"div",54),c()(),s(19,"div",55)(20,"button",56),C("click",function(){_(e);let r=d();return x(r.callSvc.toggleMute())}),y(21,Jn,3,0,":svg:svg",29)(22,Xn,3,0),c(),s(23,"button",57),C("click",function(){_(e);let r=d();return x(r.callSvc.endCall())}),v(),s(24,"svg",58),f(25,"line",15)(26,"path",16),c()(),E(),s(27,"button",56),C("click",function(){_(e);let r=d();return x(r.callSvc.toggleCamera())}),y(28,Zn,3,0,":svg:svg",29)(29,ei,2,0),c()()()}if(i&2){let e=d();l(3),b(3,e.remoteHasVideo?-1:3),l(),M("cam-off",e.callSvc.isCameraOff()),l(3),b(7,e.callSvc.isCameraOff()?7:-1),l(4),g(e.callSvc.activeCall().remoteUserName),l(2),g(e.fmt(e.callSvc.callDuration())),l(7),M("off",e.callSvc.isMuted()),l(),b(21,e.callSvc.isMuted()?21:22),l(6),M("off",e.callSvc.isCameraOff()),l(),b(28,e.callSvc.isCameraOff()?28:29)}}var pn=(()=>{class i{constructor(e,t,r){this.callSvc=e,this.zone=t,this.cdr=r,this.destroy$=new W,this.ringInterval=null,this.audioCtx=null,this.remoteHasVideo=!1,this.bars=Array.from({length:22},(o,a)=>a),de(e.callStatus).pipe(O(this.destroy$)).subscribe(o=>{o==="ringing"?this.startRing():this.stopRing()}),de(e.localStream).pipe(O(this.destroy$)).subscribe(o=>{this.tryAttach(this.localVid,o,"local"),setTimeout(()=>this.tryAttach(this.localVid,o,"local"),300)}),de(e.remoteStream).pipe(O(this.destroy$)).subscribe(o=>{o&&(console.log("[CallUI] Remote stream signal fired, tracks:",o.getTracks().map(a=>`${a.kind}(${a.readyState})`)),this.remoteHasVideo=o.getVideoTracks().some(a=>a.readyState==="live"),this.cdr.detectChanges(),this.tryAttach(this.remoteVid,o,"remote"),setTimeout(()=>this.tryAttach(this.remoteVid,o,"remote"),200),setTimeout(()=>this.tryAttach(this.remoteVid,o,"remote"),600),setTimeout(()=>this.tryAttach(this.remoteVid,o,"remote"),1200),setTimeout(()=>this.tryAttach(this.remoteVid,o,"remote"),2500))})}ngAfterViewChecked(){let e=this.callSvc.localStream(),t=this.callSvc.remoteStream();e&&this.tryAttach(this.localVid,e,"local"),t&&this.tryAttach(this.remoteVid,t,"remote")}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.stopRing()}tryAttach(e,t,r){if(!e?.nativeElement||!t)return;let o=e.nativeElement;if(o.srcObject!==t&&(console.log(`[CallUI] Attaching ${r} stream:`,t.getTracks().map(a=>`${a.kind}(${a.readyState})`).join(", ")),o.srcObject=t),o.paused&&o.play().catch(a=>{a.name!=="AbortError"&&console.warn(`[CallUI] ${r} play():`,a.message)}),r==="remote"){let a=t.getVideoTracks().some(h=>h.readyState==="live");this.remoteHasVideo!==a&&(this.remoteHasVideo=a,this.cdr.detectChanges())}}startRing(){this.stopRing();try{this.audioCtx=new AudioContext;let e=()=>{if(!this.audioCtx)return;let t=this.audioCtx.currentTime,r=this.audioCtx.createOscillator(),o=this.audioCtx.createGain();r.connect(o),o.connect(this.audioCtx.destination),r.frequency.setValueAtTime(440,t),r.frequency.setValueAtTime(490,t+.35),r.frequency.setValueAtTime(440,t+.7),o.gain.setValueAtTime(0,t),o.gain.linearRampToValueAtTime(.4,t+.05),o.gain.setValueAtTime(.4,t+.95),o.gain.exponentialRampToValueAtTime(.001,t+1.1),r.start(t),r.stop(t+1.15)};e(),this.ringInterval=setInterval(e,2200)}catch(e){console.warn("[Ring]",e)}}stopRing(){clearInterval(this.ringInterval),this.ringInterval=null;try{this.audioCtx?.close()}catch{}this.audioCtx=null}fmt(e){return`${String(Math.floor(e/60)).padStart(2,"0")}:${String(e%60).padStart(2,"0")}`}ini(e){return e?e.split(" ").map(t=>t[0]).join("").toUpperCase().slice(0,2):"?"}grad(e){let t=["linear-gradient(135deg,#6C63FF,#00D4FF)","linear-gradient(135deg,#FF6B9D,#FFB800)","linear-gradient(135deg,#00E5A0,#00D4FF)","linear-gradient(135deg,#FFB800,#FF6B9D)","linear-gradient(135deg,#8B5CF6,#EC4899)"],r=0;for(let o of e||"")r=o.charCodeAt(0)+((r<<5)-r);return t[Math.abs(r)%t.length]}static{this.\u0275fac=function(t){return new(t||i)(F($e),F(G),F(yt))}}static{this.\u0275cmp=we({type:i,selectors:[["app-call"]],viewQuery:function(t,r){if(t&1&&(J(Un,5),J(jn,5)),t&2){let o;X(o=Z())&&(r.localVid=o.first),X(o=Z())&&(r.remoteVid=o.first)}},standalone:!0,features:[Pe],decls:4,vars:4,consts:[["remoteVid",""],["localVid",""],[1,"overlay"],[1,"video-shell"],[1,"ring-card"],[1,"rp","rp1"],[1,"rp","rp2"],[1,"rp","rp3"],[1,"call-av"],[1,"call-name"],[1,"call-sub"],[1,"dots"],[1,"ring-btns"],[1,"rb","red",3,"click"],["width","26","height","26","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2.5"],["x1","1","y1","1","x2","23","y2","23"],["stroke-linecap","round","d","M16.5 12.5c-.83-.83-1.71-1.5-2.5-1.5h-4c-.79 0-2.09.67-2.83 1.41L4.5 15.08"],[1,"rb","green",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"],[1,"center-card"],[1,"end-pill",3,"click"],["width","18","height","18","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2.5"],[1,"audio-card"],[1,"wave-wrap"],[1,"wb",3,"animation-delay"],[1,"call-av","large"],[1,"call-timer"],[1,"audio-ctrls"],[1,"ac",3,"click"],["width","20","height","20","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2"],[1,"ac","end",3,"click"],["width","22","height","22","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2.5"],[1,"ac"],["points","11 5 6 9 2 9 2 15 6 15 11 19 11 5"],["d","M15.54 8.46a5 5 0 010 7.07"],["d","M19.07 4.93a10 10 0 010 14.14"],[1,"wb"],["d","M9 9v3a3 3 0 005.12 2.12M15 9.34V4a3 3 0 00-5.94-.6"],["d","M17 16.95A7 7 0 015 12v-2m14 0v2a7 7 0 01-.11 1.23"],["x1","12","y1","19","x2","12","y2","23"],["d","M12 1a3 3 0 00-3 3v8a3 3 0 006 0V4a3 3 0 00-3-3z"],["d","M19 10v2a7 7 0 01-14 0v-2"],["autoplay","","playsinline","",1,"remote-vid"],[1,"remote-blank"],[1,"local-pip"],["autoplay","","playsinline","","muted","",1,"local-vid"],[1,"pip-off"],[1,"vid-top"],[1,"vid-name"],[1,"vid-dur"],[1,"sig"],[1,"sb","s1"],[1,"sb","s2"],[1,"sb","s3"],[1,"sb","s4"],[1,"vid-ctrls"],[1,"vc",3,"click"],[1,"vc","end-vid",3,"click"],["width","24","height","24","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2.5"],[1,"call-av","xlarge"],[1,"rb-name"],[1,"rb-sub"],["width","24","height","24","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2"],["d","M21 21H3a2 2 0 01-2-2V8a2 2 0 012-2h3m3-3h6l2 3h4a2 2 0 012 2v9.34"],["d","M15 10l4.553-2.276A1 1 0 0121 8.723v6.554a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"]],template:function(t,r){if(t&1&&y(0,qn,23,5,"div",2)(1,$n,17,4,"div",2)(2,Yn,30,11,"div",2)(3,ti,30,12,"div",3),t&2){let o,a,h;b(0,(o=r.callSvc.callStatus()==="ringing"&&r.callSvc.incomingCall())?0:-1,o),l(),b(1,r.callSvc.callStatus()==="calling"?1:-1),l(),b(2,r.callSvc.callStatus()==="connected"&&((a=r.callSvc.activeCall())==null?null:a.type)==="audio"?2:-1),l(),b(3,r.callSvc.callStatus()==="connected"&&((h=r.callSvc.activeCall())==null?null:h.type)==="video"?3:-1)}},dependencies:[Ae],styles:[".overlay[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:9999;display:flex;align-items:center;justify-content:center;background:#060910f0;-webkit-backdrop-filter:blur(28px);backdrop-filter:blur(28px);animation:_ngcontent-%COMP%_fadeIn .2s ease}.ring-card[_ngcontent-%COMP%]{position:relative;width:300px;padding:48px 28px 38px;background:var(--bg-surface);border:1px solid var(--border-subtle);border-radius:28px;box-shadow:0 32px 80px #000000b3,0 0 60px #6c63ff2e;display:flex;flex-direction:column;align-items:center;gap:14px;text-align:center;overflow:hidden}.rp[_ngcontent-%COMP%]{position:absolute;border-radius:50%;border:1px solid rgba(108,99,255,.2);top:50%;left:50%;pointer-events:none;animation:_ngcontent-%COMP%_rpulse 2.5s ease-out infinite}.rp1[_ngcontent-%COMP%]{width:200px;height:200px;animation-delay:0s}.rp2[_ngcontent-%COMP%]{width:290px;height:290px;animation-delay:.6s}.rp3[_ngcontent-%COMP%]{width:380px;height:380px;animation-delay:1.2s}@keyframes _ngcontent-%COMP%_rpulse{0%{opacity:.8;transform:translate(-50%,-50%) scale(.6)}to{opacity:0;transform:translate(-50%,-50%) scale(1.2)}}.call-av[_ngcontent-%COMP%]{position:relative;z-index:1;width:84px;height:84px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-family:var(--font-display);font-weight:800;font-size:30px;color:#fff;box-shadow:0 8px 32px #6c63ff59;flex-shrink:0}.call-av.large[_ngcontent-%COMP%]{width:108px;height:108px;font-size:38px}.call-av.xlarge[_ngcontent-%COMP%]{width:136px;height:136px;font-size:50px}.call-name[_ngcontent-%COMP%]{font-family:var(--font-display);font-size:21px;font-weight:700;position:relative;z-index:1;margin:0}.call-sub[_ngcontent-%COMP%]{font-size:13px;color:var(--text-muted);position:relative;z-index:1;margin:0}.dots[_ngcontent-%COMP%]{display:flex;gap:5px;position:relative;z-index:1}.dots[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:6px;height:6px;border-radius:50%;background:var(--accent-primary);animation:_ngcontent-%COMP%_bounce 1.2s ease-in-out infinite}.dots[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(2){animation-delay:.2s}.dots[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:nth-child(3){animation-delay:.4s}@keyframes _ngcontent-%COMP%_bounce{0%,80%,to{transform:translateY(0);opacity:.4}40%{transform:translateY(-7px);opacity:1}}.ring-btns[_ngcontent-%COMP%]{display:flex;gap:26px;position:relative;z-index:1}.rb[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:50%;display:flex;align-items:center;justify-content:center;border:none;cursor:pointer;transition:all .2s cubic-bezier(.34,1.56,.64,1)}.rb.red[_ngcontent-%COMP%]{background:#ff6b6b26;color:#ff6b6b;border:1px solid rgba(255,107,107,.3)}.rb.red[_ngcontent-%COMP%]:hover{background:#ff6b6b;color:#fff;transform:scale(1.12)}.rb.green[_ngcontent-%COMP%]{background:#00e5a026;color:#00e5a0;border:1px solid rgba(0,229,160,.3);animation:_ngcontent-%COMP%_gpulse 1.3s ease infinite}.rb.green[_ngcontent-%COMP%]:hover{background:#00e5a0;color:#fff;transform:scale(1.12)}@keyframes _ngcontent-%COMP%_gpulse{0%,to{box-shadow:0 0 #00e5a066}50%{box-shadow:0 0 0 14px #00e5a000}}.center-card[_ngcontent-%COMP%]{width:280px;padding:44px 28px 36px;background:var(--bg-surface);border:1px solid var(--border-subtle);border-radius:28px;display:flex;flex-direction:column;align-items:center;gap:14px;text-align:center}.end-pill[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 24px;background:#ff6b6b1f;color:#ff6b6b;border:1px solid rgba(255,107,107,.25);border-radius:30px;cursor:pointer;font-family:var(--font-body);font-size:13.5px;font-weight:600;transition:all .2s;margin-top:6px}.end-pill[_ngcontent-%COMP%]:hover{background:#ff6b6b;color:#fff}.audio-card[_ngcontent-%COMP%]{position:relative;width:320px;padding:52px 28px 40px;background:var(--bg-surface);border:1px solid var(--border-subtle);border-radius:28px;box-shadow:0 32px 80px #000000a6;display:flex;flex-direction:column;align-items:center;gap:18px;text-align:center;overflow:hidden}.wave-wrap[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;display:flex;align-items:flex-end;justify-content:center;gap:3px;padding:0 18px;height:60px;opacity:.13;pointer-events:none}.wb[_ngcontent-%COMP%]{width:3px;min-height:4px;background:var(--accent-primary);border-radius:2px;animation:_ngcontent-%COMP%_wave .9s ease-in-out infinite alternate;height:28px}.wave-wrap.muted[_ngcontent-%COMP%]   .wb[_ngcontent-%COMP%]{animation:none!important;height:4px!important}@keyframes _ngcontent-%COMP%_wave{0%{transform:scaleY(.2)}to{transform:scaleY(1)}}.call-timer[_ngcontent-%COMP%]{font-family:var(--font-display);font-size:34px;font-weight:700;color:#00e5a0;letter-spacing:2px;margin:0}.audio-ctrls[_ngcontent-%COMP%]{display:flex;gap:14px;align-items:center;position:relative;z-index:1}.ac[_ngcontent-%COMP%]{width:58px;height:72px;border-radius:16px;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:5px;background:var(--bg-elevated);border:1px solid var(--border-subtle);cursor:pointer;color:var(--text-secondary);font-size:10px;font-weight:600;transition:all .18s}.ac[_ngcontent-%COMP%]:hover{background:var(--bg-hover);color:var(--text-primary)}.ac.on[_ngcontent-%COMP%]{background:#6c63ff26;color:var(--accent-primary);border-color:#6c63ff4d}.ac.end[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:50%;background:#ff6b6b26;color:#ff6b6b;border-color:#ff6b6b4d}.ac.end[_ngcontent-%COMP%]:hover{background:#ff6b6b;color:#fff;transform:scale(1.08)}.video-shell[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:9999;background:#000;animation:_ngcontent-%COMP%_fadeIn .2s ease}.remote-vid[_ngcontent-%COMP%]{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}.remote-blank[_ngcontent-%COMP%]{position:absolute;inset:0;background:linear-gradient(135deg,#0d1117,#0f172a);display:flex;flex-direction:column;align-items:center;justify-content:center;gap:16px}.rb-name[_ngcontent-%COMP%]{font-family:var(--font-display);font-size:22px;font-weight:700;color:#fff;margin:0}.rb-sub[_ngcontent-%COMP%]{font-size:13px;color:#fff6;margin:0}.local-pip[_ngcontent-%COMP%]{position:absolute;bottom:100px;right:18px;width:156px;height:118px;border-radius:16px;overflow:hidden;border:2px solid rgba(255,255,255,.18);box-shadow:0 8px 32px #0000008c;background:#1a1a2e;z-index:10}.local-vid[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;transform:scaleX(-1)}.pip-off[_ngcontent-%COMP%]{position:absolute;inset:0;background:var(--bg-elevated);display:flex;align-items:center;justify-content:center;color:var(--text-muted)}.vid-top[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;padding:22px 24px;background:linear-gradient(to bottom,rgba(0,0,0,.8),transparent);display:flex;align-items:flex-start;justify-content:space-between;z-index:10}.vid-name[_ngcontent-%COMP%]{font-family:var(--font-display);font-size:19px;font-weight:700;color:#fff}.vid-dur[_ngcontent-%COMP%]{font-size:13px;color:#fff9;margin-top:2px}.sig[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:2px;padding-top:4px}.sb[_ngcontent-%COMP%]{width:4px;border-radius:2px;background:#00e5a0;opacity:.9}.s1[_ngcontent-%COMP%]{height:5px}.s2[_ngcontent-%COMP%]{height:9px}.s3[_ngcontent-%COMP%]{height:13px}.s4[_ngcontent-%COMP%]{height:18px}.vid-ctrls[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;padding:24px 24px 32px;background:linear-gradient(to top,rgba(0,0,0,.85),transparent);display:flex;justify-content:center;gap:18px;align-items:center;z-index:10}.vc[_ngcontent-%COMP%]{width:54px;height:54px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:#ffffff26;border:1px solid rgba(255,255,255,.2);color:#fff;cursor:pointer;transition:all .18s;-webkit-backdrop-filter:blur(12px);backdrop-filter:blur(12px)}.vc[_ngcontent-%COMP%]:hover{background:#ffffff40;transform:scale(1.08)}.vc.off[_ngcontent-%COMP%]{background:#ff6b6b4d;border-color:#ff6b6b80;color:#ff6b6b}.end-vid[_ngcontent-%COMP%]{width:62px!important;height:62px!important;background:#ff6b6b!important;border-color:#ff6b6b!important;box-shadow:0 4px 24px #ff6b6b80}.end-vid[_ngcontent-%COMP%]:hover{transform:scale(1.12)!important}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}"]})}}return i})();var hn=(()=>{class i{transform(e){if(!e)return"";let t=new Date,r=new Date(e),o=Math.floor((t.getTime()-r.getTime())/1e3);return o<60?"now":o<3600?`${Math.floor(o/60)}m`:o<86400?`${Math.floor(o/3600)}h`:o<604800?`${Math.floor(o/86400)}d`:r.toLocaleDateString("en-IN",{day:"numeric",month:"short"})}static{this.\u0275fac=function(t){return new(t||i)}}static{this.\u0275pipe=ut({name:"timeAgo",type:i,pure:!1,standalone:!0})}}return i})();var un=(()=>{class i{constructor(e){this.http=e,this.api=Re.apiUrl,this.activeChat=w(null),this.chats=w([]),this.messages=w([]),this.typingUsers=w({})}getMyChats(){return this.http.get(`${this.api}/chats`).pipe(ce(e=>this.chats.set(e.data.chats)))}createOrGetChat(e){return this.http.post(`${this.api}/chats`,{userId:e}).pipe(ce(t=>{let r=t.data.chat;this.chats().find(a=>a._id===r._id)||this.chats.update(a=>[r,...a]),this.activeChat.set(r)}))}createGroupChat(e,t){return this.http.post(`${this.api}/chats/group`,{name:e,memberIds:t}).pipe(ce(r=>{this.chats.update(o=>[r.data.chat,...o]),this.activeChat.set(r.data.chat)}))}getMessages(e,t=1){return this.http.get(`${this.api}/messages/${e}?page=${t}&limit=50`).pipe(ce(r=>{t===1?this.messages.set(r.data.messages):this.messages.update(o=>[...r.data.messages,...o])}))}searchUsers(e){return this.http.get(`${this.api}/users?q=${e}`)}addMessage(e){this.messages.update(t=>[...t,e]),this.chats.update(t=>t.map(r=>r._id===e.chat?V(R({},r),{lastMessage:e,updatedAt:e.createdAt}):r).sort((r,o)=>new Date(o.updatedAt).getTime()-new Date(r.updatedAt).getTime()))}setTyping(e,t,r){this.typingUsers.update(o=>{let a=o[e]||[];return V(R({},o),{[e]:r?[...new Set([...a,t])]:a.filter(h=>h!==t)})})}getChatDisplayName(e,t){return e?e.type==="group"?e.name||"Group":e.members?.find(o=>o.user?._id!==t)?.user?.name||"Unknown":"Unknown"}getChatOtherUser(e,t){return!e||!e.members?null:e.members.find(r=>r.user?._id!==t)?.user||null}getAvatarColor(e){let t=["linear-gradient(135deg,#6C63FF,#00D4FF)","linear-gradient(135deg,#FF6B9D,#FFB800)","linear-gradient(135deg,#00E5A0,#00D4FF)","linear-gradient(135deg,#FFB800,#FF6B9D)","linear-gradient(135deg,#8B5CF6,#EC4899)","linear-gradient(135deg,#10B981,#3B82F6)"];if(!e||typeof e!="string")return t[0];let r=0;for(let o of e)r=o.charCodeAt(0)+((r<<5)-r);return t[Math.abs(r)%t.length]}getInitials(e){return!e||typeof e!="string"?"?":e.split(" ").map(t=>t[0]).join("").toUpperCase().slice(0,2)}static{this.\u0275fac=function(t){return new(t||i)(Q(St))}}static{this.\u0275prov=te({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var ii=["msgsEl"],ri=["anchor"],oi=["msgInp"],si=(i,n)=>n.v,lt=(i,n)=>n._id,ai=(i,n)=>n.date,ci=(i,n)=>n.emoji,li=()=>[1,2,3,4,5];function di(i,n){if(i&1&&(s(0,"span",11),p(1),c()),i&2){let e=d();l(),g(e.totalUnread()>9?"9+":e.totalUnread())}}function pi(i,n){if(i&1){let e=P();s(0,"button",42),C("click",function(){_(e);let r=d();return x(r.sq="")}),p(1,"\u2715"),c()}}function hi(i,n){i&1&&(s(0,"div",47),f(1,"div",50),c())}function ui(i,n){if(i&1){let e=P();s(0,"div",51),C("click",function(){let r=_(e).$implicit,o=d(2);return x(o.openChat(r._id,r.name))}),s(1,"div",52),p(2),c(),s(3,"div",53)(4,"span",54),p(5),c(),s(6,"span",55),p(7),c()(),s(8,"span",56),p(9),c()()}if(i&2){let e=n.$implicit,t=d(2);l(),I("background",t.avatarColor(e.name)),l(),g(t.initials(e.name)),l(3),g(e.name),l(2),g(e.email),l(),ke(e.status),l(),g(e.status)}}function fi(i,n){if(i&1&&(s(0,"div",49),p(1),c()),i&2){let e=d(2);l(),ne('No users found for "',e.pq,'"')}}function mi(i,n){if(i&1){let e=P();s(0,"div",36)(1,"div",43)(2,"span"),p(3,"New conversation"),c(),s(4,"button",44),C("click",function(){_(e);let r=d();return r.showPeople.set(!1),r.pq="",x(r.people.set([]))}),p(5,"\u2715"),c()(),s(6,"div",45)(7,"input",46),Te("ngModelChange",function(r){_(e);let o=d();return Me(o.pq,r)||(o.pq=r),x(r)}),C("ngModelChange",function(r){_(e);let o=d();return x(o.findPeople(r))}),c()(),y(8,hi,2,0,"div",47),U(9,ui,10,8,"div",48,lt),y(11,fi,2,1,"div",49),c()}if(i&2){let e=d();l(7),Oe("ngModel",e.pq),l(),b(8,e.searching()?8:-1),l(),j(e.people()),l(2),b(11,!e.searching()&&e.pq&&e.people().length===0?11:-1)}}function gi(i,n){if(i&1){let e=P();s(0,"button",57),C("click",function(){let r=_(e).$implicit,o=d();return x(o.tf.set(r.v))}),p(1),c()}if(i&2){let e=n.$implicit,t=d();M("on",t.tf()===e.v),l(),g(e.l)}}function _i(i,n){i&1&&(s(0,"div",58),f(1,"div",59),s(2,"div",60),f(3,"div",61)(4,"div",62),c()())}function xi(i,n){i&1&&U(0,_i,5,0,"div",58,Se),i&2&&j(bt(0,li))}function Ci(i,n){if(i&1){let e=P();s(0,"div",63)(1,"div",64),p(2,"\u{1F4AC}"),c(),s(3,"p"),p(4,"No conversations yet"),c(),s(5,"button",65),C("click",function(){_(e);let r=d();return x(r.showPeople.set(!0))}),p(6,"Start chatting"),c()()}}function bi(i,n){i&1&&(s(0,"em",75),p(1,"typing..."),c())}function vi(i,n){if(i&1&&p(0),i&2){let e=d().$implicit,t=d(2);g(t.preview(e))}}function yi(i,n){if(i&1&&(s(0,"span",76),p(1),c()),i&2){let e=d().$implicit;l(),g(e.unreadCount)}}function wi(i,n){if(i&1){let e=P();s(0,"div",67),C("click",function(){let r=_(e).$implicit,o=d(2);return x(o.pick(r))}),s(1,"div",68),p(2),f(3,"span",69),c(),s(4,"div",70)(5,"div",71)(6,"span",72),p(7),c(),s(8,"span",73),p(9),Ee(10,"timeAgo"),c()(),s(11,"div",71)(12,"span",74),y(13,bi,2,0,"em",75)(14,vi,1,1),c(),y(15,yi,2,1,"span",76),c()()()}if(i&2){let e,t=n.$implicit,r=d(2);M("on",((e=r.activeChat())==null?null:e._id)===t._id),l(),I("background",r.avatarColor(r.chatName(t))),l(),ne(" ",r.initials(r.chatName(t))," "),l(),ke(r.chatStatus(t)),l(4),g(r.chatName(t)),l(2),g(vt(10,13,t.lastMessage==null?null:t.lastMessage.createdAt)),l(3),M("bold",r.hasUnread(t)),l(),b(13,r.isTypingIn(t._id)?13:14),l(2),b(15,r.hasUnread(t)?15:-1)}}function ki(i,n){if(i&1&&U(0,wi,16,15,"div",66,lt),i&2){let e=d();j(e.filteredChats())}}function Si(i,n){if(i&1){let e=P();s(0,"div",41)(1,"div",77),p(2,"S"),c(),s(3,"h2",78),p(4,"Welcome to Saylo"),c(),s(5,"p",79),p(6,"Select a chat or start a new conversation"),c(),s(7,"button",65),C("click",function(){_(e);let r=d();return x(r.showPeople.set(!0))}),p(8,"New conversation"),c()()}}function Oi(i,n){if(i&1){let e=P();s(0,"button",44),C("click",function(){_(e);let r=d(2);return x(r.chatSvc.activeChat.set(null))}),v(),s(1,"svg",108),f(2,"path",109),c()()}}function Mi(i,n){i&1&&(s(0,"span",86),f(1,"span",110)(2,"span",111)(3,"span",112),p(4," typing... "),c())}function Ti(i,n){if(i&1&&(f(0,"span",113),p(1)),i&2){let e=d(2);ke(e.chatStatus(e.activeChat())),l(),ne(" ",e.chatStatusTxt(e.activeChat())," ")}}function Pi(i,n){i&1&&(s(0,"div",95),f(1,"div",50),c())}function Ei(i,n){if(i&1&&(s(0,"div",127),p(1),c()),i&2){let e=d().$implicit,t=d(3);I("background",t.avatarColor(e.sender.name)),l(),g(t.initials(e.sender.name))}}function Ai(i,n){i&1&&f(0,"div",128)}function Ri(i,n){if(i&1&&(s(0,"span",119),p(1),c()),i&2){let e=d().$implicit;l(),g(e.sender.name)}}function Vi(i,n){if(i&1&&(s(0,"div",129)(1,"span",130),p(2),c(),s(3,"span",131),p(4),Ee(5,"slice"),c()()),i&2){let e=d().$implicit,t=d(3);M("out",t.isOut(e)),l(2),g(e.replyTo.sender==null?null:e.replyTo.sender.name),l(2),g(Ge(5,4,e.replyTo.content,0,60))}}function Bi(i,n){i&1&&(s(0,"span",122),p(1,"\u{1F6AB} Message deleted"),c())}function Ni(i,n){if(i&1&&(s(0,"span",132),p(1),c()),i&2){let e=d().$implicit;l(),g(e.content)}}function Ii(i,n){i&1&&(v(),f(0,"path",136))}function Fi(i,n){if(i&1&&(s(0,"span",133),v(),s(1,"svg",134),f(2,"path",135),y(3,Ii,1,0,":svg:path",136),c()()),i&2){let e=d().$implicit,t=d(3);M("seen",t.isRead(e)),l(3),b(3,t.isRead(e)?3:-1)}}function Di(i,n){if(i&1){let e=P();s(0,"button",139),C("click",function(){let r=_(e).$implicit,o=d(2).$implicit,a=d(3);return x(a.react(o,r.emoji))}),p(1),c()}if(i&2){let e=n.$implicit;l(),Ct("",e.emoji," ",e.count,"")}}function zi(i,n){if(i&1&&(s(0,"div",137),U(1,Di,2,2,"button",138,ci),c()),i&2){let e=d().$implicit,t=d(3);M("out",t.isOut(e)),l(),j(t.groupReacts(e))}}function Li(i,n){if(i&1){let e=P();s(0,"div",116),y(1,Ei,2,3,"div",117)(2,Ai,1,0),s(3,"div",118),y(4,Ri,2,1,"span",119)(5,Vi,6,8,"div",120),s(6,"div",121),C("dblclick",function(){let r=_(e).$implicit,o=d(3);return x(o.setReply(r))}),y(7,Bi,2,0,"span",122)(8,Ni,2,1),s(9,"div",123)(10,"span",124),p(11),c(),y(12,Fi,4,3,"span",125),c()(),y(13,zi,3,2,"div",126),c()()}if(i&2){let e=n.$implicit,t=d(3);M("out",t.isOut(e))("seq",e._seq),l(),b(1,!t.isOut(e)&&!e._seq?1:t.isOut(e)?-1:2),l(3),b(4,!t.isOut(e)&&!e._seq?4:-1),l(),b(5,e.replyTo?5:-1),l(),M("inc",!t.isOut(e))("out",t.isOut(e))("del",e.isDeleted),l(),b(7,e.isDeleted?7:8),l(4),g(t.fmtTime(e.createdAt)),l(),b(12,t.isOut(e)?12:-1),l(),b(13,e.reactions.length>0?13:-1)}}function Ui(i,n){if(i&1&&(s(0,"div",114)(1,"span"),p(2),c()(),U(3,Li,14,17,"div",115,lt)),i&2){let e=n.$implicit;l(2),g(e.date),l(),j(e.messages)}}function ji(i,n){i&1&&(s(0,"div",96)(1,"div",140),v(),s(2,"svg",141),f(3,"path",142),c()(),E(),s(4,"div",143),f(5,"span",110)(6,"span",111)(7,"span",112),c()())}function qi(i,n){if(i&1){let e=P();s(0,"div",97),f(1,"div",144),s(2,"div",145)(3,"span",146),p(4),c(),s(5,"span",147),p(6),Ee(7,"slice"),c()(),s(8,"button",44),C("click",function(){_(e);let r=d(2);return x(r.replyTo.set(null))}),p(9,"\u2715"),c()()}if(i&2){let e=d(2);l(4),ne("\u21A9 Replying to ",e.replyTo().sender.name,""),l(2),g(Ge(7,2,e.replyTo().content,0,80))}}function $i(i,n){if(i&1){let e=P();s(0,"header",80),y(1,Oi,3,0,"button",81),s(2,"div",82),p(3),c(),s(4,"div",83)(5,"div",84),p(6),c(),s(7,"div",85),y(8,Mi,5,0,"span",86)(9,Ti,2,3),c()(),s(10,"div",87)(11,"button",88),C("click",function(){_(e);let r=d();return x(r.callAudio())}),v(),s(12,"svg",89),f(13,"path",13),c()(),E(),s(14,"button",90),C("click",function(){_(e);let r=d();return x(r.callVideo())}),v(),s(15,"svg",89),f(16,"path",91),c()(),E(),s(17,"button",92),v(),s(18,"svg",89),f(19,"path",93),c()()()(),E(),s(20,"div",94,0),C("scroll",function(r){_(e);let o=d();return x(o.onScroll(r))}),y(22,Pi,2,0,"div",95),U(23,Ui,5,1,null,null,ai),y(25,ji,8,0,"div",96),f(26,"div",null,1),c(),y(28,qi,10,6,"div",97),s(29,"div",98)(30,"button",99),C("click",function(){_(e);let r=xt(34);return x(r.click())}),v(),s(31,"svg",9),f(32,"path",100),c()(),E(),s(33,"input",101,2),C("change",function(r){_(e);let o=d();return x(o.onFile(r))}),c(),s(35,"div",102)(36,"input",103,3),Te("ngModelChange",function(r){_(e);let o=d();return Me(o.txt,r)||(o.txt=r),x(r)}),C("ngModelChange",function(){_(e);let r=d();return x(r.onType())})("keydown.enter",function(){_(e);let r=d();return x(r.send())})("focus",function(){_(e);let r=d();return x(r.inpFocus.set(!0))})("blur",function(){_(e);let r=d();return r.inpFocus.set(!1),x(r.stopType())}),c(),s(38,"button",104),p(39,"\u{1F60A}"),c()(),s(40,"button",105),C("click",function(){_(e);let r=d();return x(r.send())}),v(),s(41,"svg",106),f(42,"path",107),c()()()}if(i&2){let e=d();l(),b(1,e.mobile()?1:-1),l(),I("background",e.avatarColor(e.chatName(e.activeChat()))),l(),ne(" ",e.initials(e.chatName(e.activeChat()))," "),l(3),g(e.chatName(e.activeChat())),l(2),b(8,e.isTypingIn(e.activeChat()._id)?8:9),l(14),b(22,e.loadingMsgs()?22:-1),l(),j(e.msgGroups()),l(2),b(25,e.isTypingIn(e.activeChat()._id)?25:-1),l(3),b(28,e.replyTo()?28:-1),l(7),M("focus",e.inpFocus()),l(),We("placeholder","Message "+e.chatName(e.activeChat())+"..."),Oe("ngModel",e.txt),l(4),M("ready",e.txt.trim())}}var ws=(()=>{class i{constructor(e,t,r,o,a,h){this.auth=e,this.socket=t,this.chatSvc=r,this.callSvc=o,this.snack=a,this.zone=h,this.destroy$=new W,this.typingTimer=null,this.doScroll=!0,this.me=this.auth.currentUser,this.activeChat=this.chatSvc.activeChat,this.messages=this.chatSvc.messages,this.chats=this.chatSvc.chats,this.typing=this.chatSvc.typingUsers,this.loading=w(!1),this.loadingMsgs=w(!1),this.showPeople=w(!1),this.sf=w(!1),this.inpFocus=w(!1),this.searching=w(!1),this.tf=w("all"),this.replyTo=w(null),this.people=w([]),this.sq="",this.pq="",this.txt="",this.tabs=[{l:"All",v:"all"},{l:"Unread",v:"unread"},{l:"Groups",v:"groups"}],this.filteredChats=le(()=>{let u=this.chats();return this.sq&&(u=u.filter(S=>this.chatName(S).toLowerCase().includes(this.sq.toLowerCase()))),this.tf()==="unread"&&(u=u.filter(S=>this.hasUnread(S))),this.tf()==="groups"&&(u=u.filter(S=>S.type==="group")),u}),this.totalUnread=le(()=>this.chats().reduce((u,S)=>u+(S.unreadCount||0),0)),this.msgGroups=le(()=>{let u=this.messages();if(!u.length)return[];let S=[],T="",A=[];return u.forEach((z,fn)=>{let He=this.fmtDate(z.createdAt),ye=u[fn-1],mn=ye&&ye.sender._id===z.sender._id&&this.fmtDate(ye.createdAt)===He&&new Date(z.createdAt).getTime()-new Date(ye.createdAt).getTime()<12e4,dt=V(R({},z),{_seq:mn});He!==T?(A.length&&S.push({date:T,messages:A}),T=He,A=[dt]):A.push(dt)}),A.length&&S.push({date:T,messages:A}),S})}ngOnInit(){this.socket.connect(),setTimeout(()=>this.loadChats(),400),this.listenSocket()}ngAfterViewChecked(){this.doScroll&&this.scrollBottom()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete(),this.socket.disconnect()}onResize(){}mobile(){return window.innerWidth<=768}loadChats(){this.loading.set(!0),this.chatSvc.getMyChats().pipe(O(this.destroy$)).subscribe({next:()=>this.loading.set(!1),error:()=>this.loading.set(!1)})}getCallIcon(e){let t=e.lastMessage;return t?t.content?.includes("audio")?"\u{1F4DE}":t.content?.includes("video")?"\u{1F4F9}":"":""}pick(e){this.activeChat()?._id!==e._id&&(this.activeChat()&&this.socket.leaveChat(this.activeChat()._id),this.chatSvc.activeChat.set(e),this.chatSvc.messages.set([]),this.replyTo.set(null),this.doScroll=!0,this.loadingMsgs.set(!0),this.chatSvc.getMessages(e._id).pipe(O(this.destroy$)).subscribe({next:()=>{this.loadingMsgs.set(!1),this.socket.joinChat(e._id),this.doScroll=!0},error:()=>this.loadingMsgs.set(!1)}),setTimeout(()=>{let t=this.messages().filter(r=>!this.isOut(r)&&!r.readBy.some(o=>o.user===this.me()?._id)).map(r=>r._id).filter(r=>!r.startsWith("tmp_"));t.length>0&&(this.socket.markRead(e._id,t),this.chatSvc.chats.update(r=>r.map(o=>o._id===e._id?V(R({},o),{unreadCount:0}):o)))},500))}listenSocket(){this.socket.on("message:new").pipe(O(this.destroy$)).subscribe(({message:e})=>{this.zone.run(()=>{e.chat===this.activeChat()?._id?(e.sender._id===this.me()?._id&&this.chatSvc.messages.update(t=>t.filter(r=>!r._id.startsWith("tmp_"))),this.chatSvc.addMessage(e),this.doScroll=!0):this.chatSvc.chats.update(t=>t.map(r=>r._id===e.chat?V(R({},r),{lastMessage:e,unreadCount:(r.unreadCount||0)+1}):r))})}),this.socket.on("typing:start").pipe(O(this.destroy$)).subscribe(({userId:e,chatId:t})=>{e!==this.me()?._id&&this.chatSvc.setTyping(t,e,!0)}),this.socket.on("typing:stop").pipe(O(this.destroy$)).subscribe(({userId:e,chatId:t})=>this.chatSvc.setTyping(t,e,!1)),this.socket.on("user:online").pipe(O(this.destroy$)).subscribe(({userId:e})=>{this.zone.run(()=>{this.chatSvc.chats.update(t=>t.map(r=>V(R({},r),{members:r.members.map(o=>o.user._id===e?V(R({},o),{user:V(R({},o.user),{status:"online"})}):o)})))})}),this.socket.on("user:offline").pipe(O(this.destroy$)).subscribe(({userId:e})=>{this.zone.run(()=>{this.chatSvc.chats.update(t=>t.map(r=>V(R({},r),{members:r.members.map(o=>o.user._id===e?V(R({},o),{user:V(R({},o.user),{status:"offline"})}):o)})))})})}send(){let e=this.txt.trim();if(!e||!this.activeChat())return;let t=this.me(),r=this.activeChat(),o={_id:"tmp_"+Date.now(),chat:r._id,sender:{_id:t._id,name:t.name,avatar:t.avatar},type:"text",content:e,replyTo:this.replyTo(),reactions:[],readBy:[],isDeleted:!1,createdAt:new Date().toISOString()};this.chatSvc.addMessage(o),this.socket.sendMessage(r._id,e,"text",this.replyTo()?._id||null),this.txt="",this.replyTo.set(null),this.doScroll=!0,this.stopType()}onType(){this.activeChat()&&(this.socket.sendTypingStart(this.activeChat()._id),clearTimeout(this.typingTimer),this.typingTimer=setTimeout(()=>this.stopType(),2e3))}stopType(){this.activeChat()&&(clearTimeout(this.typingTimer),this.socket.sendTypingStop(this.activeChat()._id))}setReply(e){e.isDeleted||this.replyTo.set(e)}react(e,t){this.activeChat()&&this.socket.reactToMessage(e._id,this.activeChat()._id,t)}findPeople(e){if(!e.trim()){this.people.set([]);return}this.searching.set(!0),this.chatSvc.searchUsers(e).pipe(O(this.destroy$)).subscribe({next:t=>{this.people.set(t.data.users),this.searching.set(!1)},error:()=>this.searching.set(!1)})}openChat(e,t){this.chatSvc.createOrGetChat(e).pipe(O(this.destroy$)).subscribe({next:r=>{this.showPeople.set(!1),this.people.set([]),this.pq="",this.pick(r.data.chat)},error:()=>this.snack.open("Failed to open chat","\u2715")})}onFile(e){let t=e.target.files?.[0];t&&this.snack.open(`\u{1F4CE} ${t.name} \u2014 file upload in Phase 8!`,"\u2715",{duration:3e3})}logout(){this.auth.logout()}callAudio(){let e=this.getOtherUser();!e||!this.activeChat()||(this.callSvc.pendingCallerName=this.me()?.name||"Someone",this.callSvc.startCall(this.activeChat()._id,e._id,e.name,"audio"))}callVideo(){let e=this.getOtherUser();!e||!this.activeChat()||(this.callSvc.pendingCallerName=this.me()?.name||"Someone",this.callSvc.startCall(this.activeChat()._id,e._id,e.name,"video"))}getOtherUser(){let e=this.activeChat();return e?this.chatSvc.getChatOtherUser(e,this.me()?._id||""):null}onScroll(e){let t=e.target;this.doScroll=t.scrollHeight-t.scrollTop-t.clientHeight<120}scrollBottom(){try{this.anchor?.nativeElement?.scrollIntoView({behavior:"smooth"})}catch{}}isOut(e){return e.sender._id===this.me()?._id}isRead(e){return e.readBy.some(t=>(typeof t.user=="object"?t.user._id:t.user)!==this.me()?._id)}isTypingIn(e){return(this.typing()[e]||[]).length>0}hasUnread(e){return(e.unreadCount||0)>0}chatName(e){return this.chatSvc.getChatDisplayName(e,this.me()?._id||"")}chatStatus(e){return e.type==="group"?"online":this.chatSvc.getChatOtherUser(e,this.me()?._id||"")?.status||"offline"}chatStatusTxt(e){return e.type==="group"?`${e.members.length} members`:this.chatStatus(e)==="online"?"Active now":"Offline"}preview(e){return e.lastMessage?e.lastMessage.isDeleted?"\u{1F6AB} Message deleted":(e.lastMessage.sender._id===this.me()?._id?"You: ":"")+(e.lastMessage.content?.slice(0,42)||""):"No messages yet"}avatarColor(e){return this.chatSvc.getAvatarColor(e)}initials(e){return this.chatSvc.getInitials(e)}groupReacts(e){let t={};return e.reactions.forEach(r=>{t[r.emoji]=(t[r.emoji]||0)+1}),Object.entries(t).map(([r,o])=>({emoji:r,count:o}))}fmtTime(e){return new Date(e).toLocaleTimeString("en-IN",{hour:"2-digit",minute:"2-digit",hour12:!0})}fmtDate(e){let t=new Date(e),r=new Date,o=new Date(r);return o.setDate(r.getDate()-1),t.toDateString()===r.toDateString()?"Today":t.toDateString()===o.toDateString()?"Yesterday":t.toLocaleDateString("en-IN",{day:"numeric",month:"long",year:"numeric"})}static{this.\u0275fac=function(t){return new(t||i)(F(Ot),F(qe),F(un),F($e),F(At),F(G))}}static{this.\u0275cmp=we({type:i,selectors:[["app-chat"]],viewQuery:function(t,r){if(t&1&&(J(ii,5),J(ri,5),J(oi,5)),t&2){let o;X(o=Z())&&(r.msgsEl=o.first),X(o=Z())&&(r.anchor=o.first),X(o=Z())&&(r.msgInp=o.first)}},hostBindings:function(t,r){t&1&&C("resize",function(){return r.onResize()},!1,_t)},standalone:!0,features:[Pe],decls:50,vars:16,consts:[["msgsEl",""],["anchor",""],["fi",""],["msgInp",""],[1,"shell"],[1,"rail"],[1,"rail-logo"],[1,"rail-nav"],["title","Chats",1,"rail-btn","active"],["width","20","height","20","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2"],["stroke-linecap","round","stroke-linejoin","round","d","M8 12h.01M12 12h.01M16 12h.01M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2v10z"],[1,"rail-badge"],["title","Calls",1,"rail-btn"],["stroke-linecap","round","stroke-linejoin","round","d","M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"],["title","People",1,"rail-btn"],["stroke-linecap","round","stroke-linejoin","round","d","M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0z"],[1,"rail-bottom"],["title","Settings",1,"rail-btn"],["stroke-linecap","round","stroke-linejoin","round","d","M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"],["stroke-linecap","round","stroke-linejoin","round","d","M15 12a3 3 0 11-6 0 3 3 0 016 0z"],[1,"rail-user",3,"click","title"],[1,"rail-avatar"],[1,"rail-online"],[1,"sidebar"],[1,"sb-head"],[1,"sb-title"],["title","New chat",1,"icon-btn","new-btn",3,"click"],["width","16","height","16","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2.5"],["stroke-linecap","round","stroke-linejoin","round","d","M12 4v16m8-8H4"],[1,"sb-search"],[1,"search-box"],["width","14","height","14","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2.5"],["cx","11","cy","11","r","8"],["stroke-linecap","round","d","M21 21l-4.35-4.35"],["placeholder","Search conversations...",3,"ngModelChange","focus","blur","ngModel"],[1,"clr"],[1,"people-panel","animate-in"],[1,"sb-tabs"],[1,"tab",3,"on"],[1,"sb-list"],[1,"main"],[1,"welcome"],[1,"clr",3,"click"],[1,"pp-head"],[1,"icon-btn",3,"click"],[1,"pp-search"],["placeholder","Search name or email...","autofocus","",1,"pp-input",3,"ngModelChange","ngModel"],[1,"pp-loading"],[1,"pp-user"],[1,"pp-empty"],[1,"spin"],[1,"pp-user",3,"click"],[1,"pp-av"],[1,"pp-info"],[1,"pp-name"],[1,"pp-email"],[1,"pp-status"],[1,"tab",3,"click"],[1,"ske-item"],[1,"ske-av","skeleton"],[1,"ske-lines"],[1,"skeleton",2,"height","12px","width","55%"],[1,"skeleton",2,"height","10px","width","80%","margin-top","6px"],[1,"sb-empty"],[2,"font-size","40px","margin-bottom","12px"],[1,"start-btn",3,"click"],[1,"ci",3,"on"],[1,"ci",3,"click"],[1,"ci-av"],[1,"ci-dot"],[1,"ci-body"],[1,"ci-row"],[1,"ci-name"],[1,"ci-time"],[1,"ci-preview"],[1,"typing-txt"],[1,"ci-badge"],[1,"w-logo"],[1,"w-title","gradient-text"],[1,"w-sub"],[1,"mh"],[1,"icon-btn"],[1,"mh-av"],[1,"mh-info"],[1,"mh-name"],[1,"mh-status"],[1,"mh-typing"],[1,"mh-acts"],["title","Audio call",1,"mh-btn","audio",3,"click"],["width","18","height","18","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2"],["title","Video call",1,"mh-btn","video",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M15 10l4.553-2.276A1 1 0 0121 8.723v6.554a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"],["title","More",1,"mh-btn"],["stroke-linecap","round","stroke-linejoin","round","d","M5 12h.01M12 12h.01M19 12h.01"],[1,"msgs",3,"scroll"],[1,"msgs-load"],[1,"mr","animate-in"],[1,"reply-strip","animate-in"],[1,"inp-bar"],["title","Attach file",1,"inp-btn",3,"click"],["stroke-linecap","round","stroke-linejoin","round","d","M15.172 7l-6.586 6.586a2 2 0 102.828 2.828l6.414-6.586a4 4 0 00-5.656-5.656l-6.415 6.585a6 6 0 108.486 8.486L20.5 13"],["type","file","accept","image/*,video/*,audio/*,.pdf,.doc,.docx",2,"display","none",3,"change"],[1,"inp-wrap"],["type","text",1,"inp",3,"ngModelChange","keydown.enter","focus","blur","placeholder","ngModel"],["title","Emoji",1,"emoji-btn"],["title","Send",1,"send-btn",3,"click"],["width","18","height","18","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2.5"],["stroke-linecap","round","stroke-linejoin","round","d","M12 19l9 2-9-18-9 18 9-2zm0 0v-8"],["width","20","height","20","fill","none","viewBox","0 0 24 24","stroke","currentColor","stroke-width","2.5"],["stroke-linecap","round","stroke-linejoin","round","d","M15 19l-7-7 7-7"],[1,"td","td1"],[1,"td","td2"],[1,"td","td3"],[1,"mh-dot"],[1,"date-div"],[1,"mr",3,"out","seq"],[1,"mr"],[1,"mr-av",3,"background"],[1,"mb-wrap"],[1,"mb-who"],[1,"reply-bar",3,"out"],[1,"mb",3,"dblclick"],[1,"del-txt"],[1,"mb-foot"],[1,"mb-time"],[1,"mb-tick",3,"seen"],[1,"reacts",3,"out"],[1,"mr-av"],[1,"mr-sp"],[1,"reply-bar"],[1,"reply-who"],[1,"reply-txt"],[1,"mb-txt"],[1,"mb-tick"],["width","16","height","10","viewBox","0 0 16 10","fill","none"],["d","M1 5L5 9L15 1","stroke","currentColor","stroke-width","1.8","stroke-linecap","round","stroke-linejoin","round"],["d","M6 5L10 9L15 3","stroke","currentColor","stroke-width","1.8","stroke-linecap","round","stroke-linejoin","round","opacity","0.8"],[1,"reacts"],[1,"react-chip"],[1,"react-chip",3,"click"],[1,"mr-av",2,"background","var(--bg-elevated)"],["width","12","height","12","fill","none","viewBox","0 0 24 24","stroke","var(--text-muted)","stroke-width","2"],["stroke-linecap","round","stroke-linejoin","round","d","M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"],[1,"typing-bub"],[1,"rs-line"],[1,"rs-info"],[1,"rs-name"],[1,"rs-txt"]],template:function(t,r){if(t&1&&(s(0,"div",4)(1,"nav",5)(2,"div",6),p(3,"S"),c(),s(4,"div",7)(5,"button",8),v(),s(6,"svg",9),f(7,"path",10),c(),y(8,di,2,1,"span",11),c(),E(),s(9,"button",12),v(),s(10,"svg",9),f(11,"path",13),c()(),E(),s(12,"button",14),v(),s(13,"svg",9),f(14,"path",15),c()()(),E(),s(15,"div",16)(16,"button",17),v(),s(17,"svg",9),f(18,"path",18)(19,"path",19),c()(),E(),s(20,"button",20),C("click",function(){return r.logout()}),s(21,"div",21),p(22),c(),f(23,"span",22),c()()(),s(24,"aside",23)(25,"div",24)(26,"h1",25),p(27,"Messages"),c(),s(28,"button",26),C("click",function(){return r.showPeople.set(!0)}),v(),s(29,"svg",27),f(30,"path",28),c()()(),E(),s(31,"div",29)(32,"div",30),v(),s(33,"svg",31),f(34,"circle",32)(35,"path",33),c(),E(),s(36,"input",34),Te("ngModelChange",function(a){return Me(r.sq,a)||(r.sq=a),a}),C("focus",function(){return r.sf.set(!0)})("blur",function(){return r.sf.set(!1)}),c(),y(37,pi,2,0,"button",35),c()(),y(38,mi,12,3,"div",36),s(39,"div",37),U(40,gi,2,3,"button",38,si),c(),s(42,"div",39),y(43,xi,2,1)(44,Ci,7,0)(45,ki,2,0),c()(),s(46,"main",40),y(47,Si,9,0,"div",41)(48,$i,43,15),c(),f(49,"app-call"),c()),t&2){let o,a,h;l(8),b(8,r.totalUnread()>0?8:-1),l(12),We("title",((o=r.me())==null?null:o.name)||"Me"),l(),I("background",r.avatarColor(((a=r.me())==null?null:a.name)||"U")),l(),g(r.initials(((h=r.me())==null?null:h.name)||"U")),l(2),M("hidden",r.activeChat()&&r.mobile()),l(8),M("focus",r.sf()),l(4),Oe("ngModel",r.sq),l(),b(37,r.sq?37:-1),l(),b(38,r.showPeople()?38:-1),l(2),j(r.tabs),l(3),b(43,r.loading()?43:r.filteredChats().length===0?44:45),l(3),M("show",r.activeChat()||!r.mobile()),l(),b(47,r.activeChat()?48:47)}},dependencies:[Ae,kt,Et,Mt,Tt,Pt,hn,Rt,pn],styles:['[_nghost-%COMP%]{display:flex;height:100vh;overflow:hidden}.shell[_ngcontent-%COMP%]{display:grid;grid-template-columns:64px 300px 1fr;width:100vw;height:100vh;overflow:hidden;background:var(--bg-void);font-family:var(--font-body)}.rail[_ngcontent-%COMP%]{background:#060910;border-right:1px solid var(--border-subtle);display:flex;flex-direction:column;align-items:center;padding:16px 0;gap:4px;z-index:20}.rail-logo[_ngcontent-%COMP%]{width:36px;height:36px;background:var(--grad-cyber);border-radius:10px;display:flex;align-items:center;justify-content:center;font-family:var(--font-display);font-weight:800;font-size:15px;color:#fff;box-shadow:0 4px 16px #6c63ff73;margin-bottom:16px;flex-shrink:0}.rail-nav[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:2px;flex:1}.rail-bottom[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:8px}.rail-btn[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:11px;display:flex;align-items:center;justify-content:center;background:none;border:none;cursor:pointer;color:var(--text-muted);transition:all .2s;position:relative}.rail-btn[_ngcontent-%COMP%]:hover{background:var(--bg-hover);color:var(--text-secondary)}.rail-btn.active[_ngcontent-%COMP%]{background:#6c63ff26;color:var(--accent-primary)}.rail-btn.active[_ngcontent-%COMP%]:before{content:"";position:absolute;left:-1px;top:50%;transform:translateY(-50%);width:3px;height:16px;background:var(--accent-primary);border-radius:0 2px 2px 0}.rail-badge[_ngcontent-%COMP%]{position:absolute;top:4px;right:4px;min-width:15px;height:15px;padding:0 3px;background:var(--accent-tertiary);border-radius:8px;border:2px solid #060910;font-size:8px;font-weight:700;color:#fff;display:flex;align-items:center;justify-content:center}.rail-user[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;position:relative;width:34px;height:34px}.rail-avatar[_ngcontent-%COMP%]{width:34px;height:34px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-family:var(--font-display);font-weight:700;font-size:12px;color:#fff}.rail-online[_ngcontent-%COMP%]{position:absolute;bottom:0;right:0;width:9px;height:9px;background:var(--accent-green);border-radius:50%;border:2px solid #060910}.sidebar[_ngcontent-%COMP%]{background:var(--bg-surface);border-right:1px solid var(--border-subtle);display:flex;flex-direction:column;overflow:hidden;z-index:15;position:relative}.sb-head[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:18px 14px 10px}.sb-title[_ngcontent-%COMP%]{font-family:var(--font-display);font-size:19px;font-weight:700;letter-spacing:-.3px}.icon-btn[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:9px;display:flex;align-items:center;justify-content:center;background:none;border:none;cursor:pointer;color:var(--text-muted);transition:all .15s}.icon-btn[_ngcontent-%COMP%]:hover{background:var(--bg-hover);color:var(--accent-primary)}.new-btn[_ngcontent-%COMP%]{background:#6c63ff1f;color:var(--accent-primary)}.sb-search[_ngcontent-%COMP%]{padding:0 10px 8px}.search-box[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:12px;padding:8px 12px;transition:border-color .15s}.search-box.focus[_ngcontent-%COMP%]{border-color:var(--border-active)}.search-box[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:var(--text-muted);flex-shrink:0}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{background:none;border:none;outline:none;color:var(--text-primary);font-family:var(--font-body);font-size:13px;flex:1}.search-box[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:var(--text-muted)}.clr[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;color:var(--text-muted);font-size:11px}.people-panel[_ngcontent-%COMP%]{position:absolute;inset:0;background:var(--bg-surface);z-index:30;display:flex;flex-direction:column}.pp-head[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:14px;border-bottom:1px solid var(--border-subtle);font-family:var(--font-display);font-weight:600;font-size:14px}.pp-search[_ngcontent-%COMP%]{padding:10px 14px}.pp-input[_ngcontent-%COMP%]{width:100%;padding:9px 12px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:10px;color:var(--text-primary);font-family:var(--font-body);font-size:13px;outline:none}.pp-input[_ngcontent-%COMP%]:focus{border-color:var(--border-focus)}.pp-input[_ngcontent-%COMP%]::placeholder{color:var(--text-muted)}.pp-loading[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:20px}.pp-user[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:11px 14px;cursor:pointer;border-bottom:1px solid var(--border-subtle);transition:background .15s}.pp-user[_ngcontent-%COMP%]:hover{background:var(--bg-hover)}.pp-av[_ngcontent-%COMP%]{width:38px;height:38px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-family:var(--font-display);font-weight:700;font-size:13px;color:#fff;flex-shrink:0}.pp-info[_ngcontent-%COMP%]{flex:1}.pp-name[_ngcontent-%COMP%]{display:block;font-weight:600;font-size:13.5px}.pp-email[_ngcontent-%COMP%]{font-size:11.5px;color:var(--text-muted)}.pp-status[_ngcontent-%COMP%]{font-size:10px;font-weight:600;padding:2px 7px;border-radius:20px}.pp-status.online[_ngcontent-%COMP%]{background:#00e5a01a;color:var(--accent-green)}.pp-status.offline[_ngcontent-%COMP%]{background:var(--bg-elevated);color:var(--text-muted)}.pp-empty[_ngcontent-%COMP%]{padding:24px;text-align:center;font-size:13px;color:var(--text-muted)}.sb-tabs[_ngcontent-%COMP%]{display:flex;gap:4px;padding:0 10px 8px}.tab[_ngcontent-%COMP%]{padding:4px 12px;border-radius:20px;font-size:11.5px;font-weight:500;background:none;border:1px solid transparent;cursor:pointer;color:var(--text-muted);transition:all .15s}.tab[_ngcontent-%COMP%]:hover{color:var(--text-secondary)}.tab.on[_ngcontent-%COMP%]{background:#6c63ff1f;color:var(--accent-primary);border-color:#6c63ff33}.sb-list[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:4px 6px}.sb-list[_ngcontent-%COMP%]::-webkit-scrollbar{width:3px}.sb-list[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--border-subtle);border-radius:2px}.ske-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:10px}.ske-av[_ngcontent-%COMP%]{width:42px;height:42px;border-radius:50%;flex-shrink:0}.ske-lines[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:6px}.sb-empty[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:180px;text-align:center;color:var(--text-muted);font-size:13px;gap:8px}.start-btn[_ngcontent-%COMP%]{padding:8px 18px;background:var(--grad-brand);color:#fff;border:none;border-radius:10px;font-family:var(--font-body);font-size:13px;font-weight:600;cursor:pointer;transition:all .2s;margin-top:8px}.start-btn[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 4px 16px #6c63ff66}.ci[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:9px 8px;border-radius:12px;cursor:pointer;transition:background .12s;margin-bottom:2px}.ci[_ngcontent-%COMP%]:hover{background:var(--bg-hover)}.ci.on[_ngcontent-%COMP%]{background:#6c63ff1a;border:1px solid rgba(108,99,255,.14)}.ci-av[_ngcontent-%COMP%]{width:42px;height:42px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-family:var(--font-display);font-weight:700;font-size:13px;color:#fff;flex-shrink:0;position:relative}.ci-dot[_ngcontent-%COMP%]{position:absolute;bottom:1px;right:1px;width:10px;height:10px;border-radius:50%;border:2px solid var(--bg-surface)}.ci-dot.online[_ngcontent-%COMP%]{background:var(--accent-green)}.ci-dot.offline[_ngcontent-%COMP%]{background:var(--text-muted)}.ci-dot.busy[_ngcontent-%COMP%]{background:var(--accent-red)}.ci-body[_ngcontent-%COMP%]{flex:1;min-width:0}.ci-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:4px;margin-bottom:2px}.ci-name[_ngcontent-%COMP%]{font-family:var(--font-display);font-size:13px;font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ci-time[_ngcontent-%COMP%]{font-size:10.5px;color:var(--text-muted);flex-shrink:0}.ci-preview[_ngcontent-%COMP%]{font-size:12px;color:var(--text-muted);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex:1}.ci-preview.bold[_ngcontent-%COMP%]{color:var(--text-secondary);font-weight:500}.typing-txt[_ngcontent-%COMP%]{color:var(--accent-primary);font-style:italic}.ci-badge[_ngcontent-%COMP%]{min-width:17px;height:17px;padding:0 4px;background:var(--accent-primary);border-radius:9px;font-size:9.5px;font-weight:700;color:#fff;display:flex;align-items:center;justify-content:center;flex-shrink:0}.main[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100vh;background:var(--bg-deep);overflow:hidden;z-index:10}.welcome[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:12px;text-align:center}.w-logo[_ngcontent-%COMP%]{width:72px;height:72px;background:var(--grad-cyber);border-radius:20px;display:flex;align-items:center;justify-content:center;font-family:var(--font-display);font-weight:800;font-size:30px;color:#fff;box-shadow:0 8px 32px #6c63ff59;margin-bottom:8px}.w-title[_ngcontent-%COMP%]{font-family:var(--font-display);font-size:26px;font-weight:700}.w-sub[_ngcontent-%COMP%]{color:var(--text-muted);font-size:14px;margin-bottom:8px}.mh[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0 18px;gap:10px;height:62px;flex-shrink:0;border-bottom:1px solid var(--border-subtle);background:#0d1117e6;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px)}.mh-av[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-family:var(--font-display);font-weight:700;font-size:12px;color:#fff;flex-shrink:0}.mh-info[_ngcontent-%COMP%]{flex:1}.mh-name[_ngcontent-%COMP%]{font-family:var(--font-display);font-size:14.5px;font-weight:700;letter-spacing:-.2px}.mh-status[_ngcontent-%COMP%]{font-size:11.5px;color:var(--text-muted);display:flex;align-items:center;gap:5px;margin-top:1px}.mh-dot[_ngcontent-%COMP%]{width:6px;height:6px;border-radius:50%;display:inline-block}.mh-dot.online[_ngcontent-%COMP%]{background:var(--accent-green)}.mh-dot.offline[_ngcontent-%COMP%]{background:var(--text-muted)}.mh-typing[_ngcontent-%COMP%]{color:var(--accent-primary);font-style:italic;display:flex;align-items:center;gap:4px}.mh-acts[_ngcontent-%COMP%]{display:flex;gap:4px}.mh-btn[_ngcontent-%COMP%]{width:34px;height:34px;border-radius:9px;display:flex;align-items:center;justify-content:center;background:none;border:none;cursor:pointer;color:var(--text-secondary);transition:all .15s}.mh-btn[_ngcontent-%COMP%]:hover{background:var(--bg-hover)}.mh-btn.audio[_ngcontent-%COMP%]:hover{color:var(--accent-green);background:#00e5a014}.mh-btn.video[_ngcontent-%COMP%]:hover{color:var(--accent-secondary);background:#00d4ff14}.msgs[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:14px 18px;display:flex;flex-direction:column;gap:2px;min-height:0}.msgs[_ngcontent-%COMP%]::-webkit-scrollbar{width:3px}.msgs[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--border-subtle);border-radius:2px}.msgs-load[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:24px}.date-div[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:10px 0;flex-shrink:0}.date-div[_ngcontent-%COMP%]:before, .date-div[_ngcontent-%COMP%]:after{content:"";flex:1;height:1px;background:var(--border-subtle)}.date-div[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:10.5px;color:var(--text-muted);font-weight:500;padding:3px 10px;background:var(--bg-elevated);border-radius:20px;border:1px solid var(--border-subtle);white-space:nowrap}.mr[_ngcontent-%COMP%]{display:flex;align-items:flex-end;gap:7px;animation:_ngcontent-%COMP%_fadeUp .2s ease forwards}.mr.out[_ngcontent-%COMP%]{flex-direction:row-reverse}.mr.seq[_ngcontent-%COMP%]{margin-top:-3px}.mr-av[_ngcontent-%COMP%]{width:26px;height:26px;border-radius:50%;flex-shrink:0;display:flex;align-items:center;justify-content:center;font-family:var(--font-display);font-weight:700;font-size:9px;color:#fff;margin-bottom:2px}.mr-sp[_ngcontent-%COMP%]{width:26px;flex-shrink:0}.mb-wrap[_ngcontent-%COMP%]{max-width:66%;display:flex;flex-direction:column;gap:2px}.mr.out[_ngcontent-%COMP%]   .mb-wrap[_ngcontent-%COMP%]{align-items:flex-end}.mb-who[_ngcontent-%COMP%]{font-size:10.5px;color:var(--text-muted);font-weight:600;padding:0 10px}.reply-bar[_ngcontent-%COMP%]{padding:5px 9px;background:var(--bg-elevated);border-left:3px solid var(--accent-primary);border-radius:7px;margin-bottom:2px}.reply-bar.out[_ngcontent-%COMP%]{border-left-color:#ffffff59}.reply-who[_ngcontent-%COMP%]{display:block;font-size:10.5px;font-weight:600;color:var(--accent-primary)}.reply-txt[_ngcontent-%COMP%]{font-size:11.5px;color:var(--text-muted)}.mb[_ngcontent-%COMP%]{padding:9px 13px;border-radius:16px;word-break:break-word;position:relative}.mb.inc[_ngcontent-%COMP%]{background:var(--bg-elevated);border:1px solid var(--border-subtle);border-bottom-left-radius:3px;color:var(--text-primary)}.mb.out[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--accent-primary),#8B5CF6);border-bottom-right-radius:3px;color:#fff}.mb.del[_ngcontent-%COMP%]{opacity:.5;background:var(--bg-elevated)!important}.mb-txt[_ngcontent-%COMP%]{font-size:13.5px;line-height:1.5}.del-txt[_ngcontent-%COMP%]{font-size:12.5px;font-style:italic;color:var(--text-muted)}.mb-foot[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:flex-end;gap:3px;margin-top:3px}.mb-time[_ngcontent-%COMP%]{font-size:10px;opacity:.6}.mb.out[_ngcontent-%COMP%]   .mb-time[_ngcontent-%COMP%]{color:#ffffffbf}.mb-tick[_ngcontent-%COMP%]{display:flex;align-items:center;color:#fff9}.mb-tick.seen[_ngcontent-%COMP%]{color:#67e8d8}.reacts[_ngcontent-%COMP%]{display:flex;gap:3px;flex-wrap:wrap}.reacts.out[_ngcontent-%COMP%]{justify-content:flex-end}.react-chip[_ngcontent-%COMP%]{background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:20px;padding:2px 7px;font-size:11.5px;cursor:pointer;transition:all .12s}.react-chip[_ngcontent-%COMP%]:hover{border-color:var(--border-active)}.typing-bub[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;padding:11px 14px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:16px 16px 16px 3px}.td[_ngcontent-%COMP%]{width:5px;height:5px;border-radius:50%;background:var(--accent-primary);display:inline-block;animation:_ngcontent-%COMP%_tdBounce 1.2s ease-in-out infinite}.td1[_ngcontent-%COMP%]{animation-delay:0s}.td2[_ngcontent-%COMP%]{animation-delay:.2s}.td3[_ngcontent-%COMP%]{animation-delay:.4s}.reply-strip[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;padding:7px 14px;background:var(--bg-elevated);border-top:1px solid var(--border-subtle);flex-shrink:0}.rs-line[_ngcontent-%COMP%]{width:3px;height:30px;background:var(--accent-primary);border-radius:2px;flex-shrink:0}.rs-info[_ngcontent-%COMP%]{flex:1}.rs-name[_ngcontent-%COMP%]{display:block;font-size:11px;font-weight:600;color:var(--accent-primary)}.rs-txt[_ngcontent-%COMP%]{font-size:11.5px;color:var(--text-muted)}.inp-bar[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;border-top:1px solid var(--border-subtle);background:#0d1117f2;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);flex-shrink:0}.inp-btn[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:9px;display:flex;align-items:center;justify-content:center;background:none;border:none;cursor:pointer;color:var(--text-muted);transition:all .15s;flex-shrink:0}.inp-btn[_ngcontent-%COMP%]:hover{background:var(--bg-hover);color:var(--accent-primary)}.inp-wrap[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;gap:6px;background:var(--bg-elevated);border:1px solid var(--border-subtle);border-radius:22px;padding:9px 14px;transition:border-color .15s}.inp-wrap.focus[_ngcontent-%COMP%]{border-color:var(--border-active)}.inp[_ngcontent-%COMP%]{flex:1;background:none;border:none;outline:none;color:var(--text-primary);font-family:var(--font-body);font-size:13.5px}.inp[_ngcontent-%COMP%]::placeholder{color:var(--text-muted)}.emoji-btn[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;font-size:17px;display:flex;transition:transform .15s}.emoji-btn[_ngcontent-%COMP%]:hover{transform:scale(1.2)}.send-btn[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:var(--bg-elevated);border:1px solid var(--border-subtle);cursor:pointer;color:var(--text-muted);transition:all .2s cubic-bezier(.34,1.56,.64,1);flex-shrink:0}.send-btn.ready[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--accent-primary),#8B5CF6);border-color:transparent;color:#fff;box-shadow:0 4px 16px #6c63ff66}.send-btn.ready[_ngcontent-%COMP%]:hover{transform:scale(1.1);box-shadow:0 6px 20px #6c63ff80}.spin[_ngcontent-%COMP%]{width:20px;height:20px;border:2px solid var(--border-subtle);border-top-color:var(--accent-primary);border-radius:50%;animation:_ngcontent-%COMP%_spinA .7s linear infinite}@keyframes _ngcontent-%COMP%_fadeUp{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_tdBounce{0%,80%,to{transform:translateY(0);opacity:.4}40%{transform:translateY(-6px);opacity:1}}@keyframes _ngcontent-%COMP%_spinA{to{transform:rotate(360deg)}}.animate-in[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeUp .25s ease forwards}@media (max-width:768px){.shell[_ngcontent-%COMP%]{grid-template-columns:0 100% 0}.rail[_ngcontent-%COMP%]{display:none}.sidebar[_ngcontent-%COMP%]{width:100%;grid-column:2}.sidebar.hidden[_ngcontent-%COMP%]{display:none}.main[_ngcontent-%COMP%]{grid-column:2}.main[_ngcontent-%COMP%]:not(.show){display:none}}']})}}return i})();export{ws as ChatComponent};
